import{P as e}from"./press-icon-plus.f1d8042d.js";import{a as t,P as s}from"./press-tab.9d77d5ed.js";import{s as a}from"./style.0f94ff97.js";import{u as l}from"./utils.af51e914.js";import{n as o}from"./add-unit.856043c8.js";import{_ as i,o as n,c,r,t as u,q as d,f as h,h as p,w as v,F as m,p as f,i as y,n as C,j as b,e as x}from"./index-ea4fd344.js";import{P as g}from"./press-field.c9120a77.js";import{P as k}from"./press-popup-plus.22853ebd.js";import{b as A}from"./press-component.45fcd844.js";import{g as O}from"./computed.f6f3e541.js";import{h as w}from"./hide-keyboard.85733fa2.js";import"./press-info.b2b7deb0.js";import"./press-sticky.1d1d68bb.js";import"./rect.f9d9bf4c.js";import"./version.3d5541ce.js";import"./bind-event.6de1e976.js";import"./event.09d4935e.js";import"./support-passive.bc409298.js";import"./touch.bcbb2f5b.js";import"./relation.8b10893c.js";import"./parent-map.b443f4cc.js";import"./scroll-view.df3f3efe.js";import"./press-cell.91729e2e.js";import"./link.d57c7ef5.js";import"./parent.59fa8a22.js";import"./press-overlay.94d366dc.js";import"./press-transition.f9d91518.js";function F(e,t,s){return e.selected&&e.selected[t]===s[t]}const j={isSelected:F,optionClass:function(e,t,s){return l.bem2("cascader__option",{selected:F(e,t,s),disabled:s.disabled})},optionStyle:function(e){const t=e.option.color||(F(e.tab,e.valueKey,e.option)?e.activeColor:void 0);return a({color:t})}};let _;var N;(N=_||(_={})).TEXT="text",N.VALUE="value",N.CHILDREN="children";const V={text:_.TEXT,value:_.VALUE,children:_.CHILDREN},L={name:"PressCascader",options:{styleIsolation:"shared"},components:{PressIcon:e,PressTab:t,PressTabs:s},props:{title:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:"请选择"},activeColor:{type:String,default:"#1989fa"},options:{type:Array,default:()=>[]},swipeable:{type:Boolean,default:!1},closeable:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},closeIcon:{type:String,default:"cross"},fieldNames:{type:Object,default:()=>V},useTitleSlot:Boolean},emits:["change","finish","close","click-tab"],data:()=>({tabs:[],activeTab:0,textKey:_.TEXT,valueKey:_.VALUE,childrenKey:_.CHILDREN,innerValue:"",utils:j}),watch:{options:{handler(){this.updateTabs()},deep:!0},value:{handler(e){this.updateValue(e)},deep:!0,immediate:!0},fieldNames:{handler(){this.updateFieldNames()},deep:!0,immediate:!0}},created(){this.updateTabs()},mounted(){},methods:{updateValue(e){if(void 0!==e){if(this.tabs.map((e=>e.selected&&e.selected[this.valueKey])).indexOf(e)>-1)return}this.innerValue=e,this.updateTabs()},updateFieldNames(){const{text:e="text",value:t="value",children:s="children"}=this.fieldNames||V;this.textKey=e,this.valueKey=t,this.childrenKey=s},getSelectedOptionsByValue(e,t){for(let s=0;s<e.length;s++){const a=e[s];if(a[this.valueKey]===t)return[a];if(a[this.childrenKey]){const e=this.getSelectedOptionsByValue(a[this.childrenKey],t);if(e)return[a,...e]}}},updateTabs(){const{options:e}=this,{innerValue:t}=this;if(e.length){if(void 0!==t){const s=this.getSelectedOptionsByValue(e,t);if(s){let t=e;const a=s.map((e=>{const s={options:t,selected:e},a=t.find((t=>t[this.valueKey]===e[this.valueKey]));return a&&(t=a[this.childrenKey]),s}));return t&&a.push({options:t,selected:null}),this.tabs=a,void o((()=>{this.activeTab=a.length-1}))}}this.tabs=[{options:e,selected:null}],this.activeTab=0}},onClose(){this.$emit("close")},onClickTab(e){const{index:t,title:s}=e;this.$emit("click-tab",{title:s,tabIndex:t}),this.activeTab=t},onSelect(e,t){if(t&&t.disabled)return;const{valueKey:s,childrenKey:a}=this;let{tabs:l}=this;if(l[e].selected=t,l.length>e+1&&(l=l.slice(0,e+1)),t[a]){const s={options:t[a],selected:null};l[e+1]?l[e+1]=s:l.push(s),o((()=>{this.activeTab=e+1}))}this.tabs=l;const i=l.map((e=>e.selected)).filter(Boolean),n=t[s],c={value:n,tabIndex:e,selectedOptions:i};this.innerValue=n,this.$emit("change",c),t[a]||this.$emit("finish",c)},getOptionsClass(e,t){return`${e.className||""} ${j.optionClass(t,this.valueKey,e)}`},getOptionsStyle(e,t){const{valueKey:s,activeColor:a}=this;return`${j.optionStyle({tab:t,valueKey:s,option:e,activeColor:a})}`},getUniqueKey:(e,t)=>`${e}-${t}`}};const K=(e,t,s)=>({text:e,value:t,children:s});function S(){return new Promise(((e,t)=>{O().then((t=>{const s=function(e){const{city_list:t,county_list:s,province_list:a}=e,l=new Map;Object.keys(a).forEach((e=>{l.set(e.slice(0,2),K(a[e],e,[]))}));const o=new Map;return Object.keys(t).forEach((e=>{const s=K(t[e],e,[]);o.set(e.slice(0,4),s);const a=l.get(e.slice(0,2));a&&a.children.push(s)})),Object.keys(s).forEach((e=>{const t=o.get(e.slice(0,4));t&&t.children.push(K(s[e],e))})),Array.from(l.values())}(t);e(s)})).catch((e=>{t(e)}))}))}const T=[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100"}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100"}]}];const D=i({i18n:{"zh-CN":{area:"地区",options:[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100",children:[{text:"上城区",value:"330102"},{text:"下城区",value:"330103"},{text:"江干区",value:"330104"}]},{text:"宁波市",value:"330200",children:[{text:"海曙区",value:"330203"},{text:"江北区",value:"330205"},{text:"北仑区",value:"330206"}]},{text:"温州市",value:"330300",children:[{text:"鹿城区",value:"330302"},{text:"龙湾区",value:"330303"},{text:"瓯海区",value:"330304"}]}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100",children:[{text:"玄武区",value:"320102"},{text:"秦淮区",value:"320104"},{text:"建邺区",value:"320105"}]},{text:"无锡市",value:"320200",children:[{text:"锡山区",value:"320205"},{text:"惠山区",value:"320206"},{text:"滨湖区",value:"320211"}]},{text:"徐州市",value:"320300",children:[{text:"鼓楼区",value:"320302"},{text:"云龙区",value:"320303"},{text:"贾汪区",value:"320305"}]}]}],selectArea:"请选择地区",customColor:"自定义颜色",asyncOptions:"异步加载选项",asyncOptions1:[{text:"浙江省",value:"330000",children:[]}],asyncOptions2:[{text:"杭州市",value:"330100"},{text:"宁波市",value:"330200"}],currentLevel:e=>`当前为第 ${e} 级`,chinaAreaData:"中国省市区数据",customContent:"自定义选项上方内容",customFieldNames:"自定义字段名"},"en-US":{area:"Area",options:[{text:"Zhejiang",value:"330000",children:[{text:"Hangzhou",value:"330100",children:[{text:"Shangcheng",value:"330102"},{text:"Xiacheng",value:"330103"},{text:"Jianggan",value:"330104"}]},{text:"Ningbo",value:"330200",children:[{text:"Haishu",value:"330203"},{text:"Jiangbei",value:"330205"},{text:"Beilun",value:"330206"}]},{text:"Wenzhou",value:"330300",children:[{text:"Lucheng",value:"330302"},{text:"Longwan",value:"330303"},{text:"Ouhai",value:"330304"}]}]},{text:"Jiangsu",value:"320000",children:[{text:"Nanjing",value:"320100",children:[{text:"Xuanwu",value:"320102"},{text:"Qinghuai",value:"320104"},{text:"Jianye",value:"320105"}]},{text:"Wuxi",value:"320200",children:[{text:"Xishan",value:"320205"},{text:"Huishan",value:"320206"},{text:"Binhu",value:"320211"}]},{text:"Xuzhou",value:"320300",children:[{text:"Gulou",value:"320302"},{text:"Yunlong",value:"320303"},{text:"Jiawang",value:"320305"}]}]}],selectArea:"Select Area",customColor:"Custom Color",asyncOptions:"Async Options",asyncOptions1:[{text:"Zhejiang",value:"330000",children:[]}],asyncOptions2:[{text:"Hangzhou",value:"330100"},{text:"Ningbo",value:"330200"}],currentLevel:e=>`Current level is ${e}`,chinaAreaData:"China Area Data",customContent:"Custom Content",customFieldNames:"Custom Field Names"}},components:{PressCascader:i(L,[["render",function(e,t,s,a,l,o){const i=x("press-icon"),g=x("press-tab"),k=x("press-tabs");return n(),c("div",{class:"press-cascader-index"},[s.showHeader?(n(),c("div",{key:0,class:"press-cascader__header"},[s.useTitleSlot?r(e.$slots,"title",{key:0},void 0,!0):(n(),c("span",{key:1,class:"press-cascader__title"},u(s.title),1)),s.closeable?(n(),d(i,{key:2,name:s.closeIcon,class:"press-cascader__close-icon",onClick:o.onClose},null,8,["name","onClick"])):h("v-if",!0)])):h("v-if",!0),p(k,{ref:"tabs",active:l.activeTab,"custom-class":"press-cascader__tabs","wrap-class":"press-cascader__tabs-wrap","tab-class":"press-cascader__tab",color:s.activeColor,border:!1,swipeable:s.swipeable,onClick:o.onClickTab},{default:v((()=>[(n(!0),c(m,null,f(l.tabs,((e,t)=>(n(),d(g,{key:e.tabIndex,title:e.selected?e.selected[l.textKey]:s.placeholder,style:{width:"100%"},"title-style":e.selected?"":"color: #969799;font-weight:normal;"},{default:v((()=>[y("div",{class:"press-cascader__options"},[(n(!0),c(m,null,f(e.options,((s,a)=>(n(),c("div",{key:""+o.getUniqueKey(a,"option"),class:C([`${o.getOptionsClass(s,e)}`]),style:b(""+o.getOptionsStyle(s,e)),onClick:()=>o.onSelect(t,s)},[y("span",null,u(s[l.textKey]),1),l.utils.isSelected(e,l.valueKey,s)?(n(),d(i,{key:0,name:"success",size:"18"})):h("v-if",!0)],14,["onClick"])))),128))])])),_:2},1032,["title","title-style"])))),128))])),_:1},8,["active","color","swipeable","onClick"])])}],["__scopeId","data-v-c30cf7dc"]]),PressField:g,PressPopupPlus:k},data(){return{show:{basic:!1,customColor:!1,asyncOptions:!1,customFieldNames:!1,chinaArea:!1},leaving:{basic:!1,customColor:!1,asyncOptions:!1,customFieldNames:!1,chinaArea:!1},options:T,fieldValue:{basic:"",customColor:"",asyncOptions:"",customFieldNames:"",chinaArea:""},cascaderValue:{basic:"",customColor:"",asyncOptions:"",customFieldNames:"",chinaArea:""},curDemo:"",asyncStateOptions:this.t("asyncOptions1"),fieldNames:{text:"name",value:"code",children:"items"},chinaArea:[]}},computed:{isMp:()=>!1,customFieldOptions(){return function(e){const t=A(e),s=e=>{"text"in e&&(e.name=e.text,delete e.text),"value"in e&&(e.code=e.value,delete e.value),"children"in e&&(e.items=e.children,delete e.children,e.items.forEach(s))};return t.forEach(s),t}(this.t("options"))}},mounted(){this.getChinaArea()},methods:{onClick(e){w(),this.curDemo=e,this.show[e]=!0,this.leaving[this.curDemo]=!0},onClose(){this.show[this.curDemo]=!1},onFinish(e){console.log("[onFinish] detail: ",e);const{selectedOptions:t,value:s}=e,a=t.map((e=>e.text||e.name)).join("/");this.fieldValue[this.curDemo]=a,this.cascaderValue[this.curDemo]=s,this.onClose()},loadDynamicOptions(e){const{value:t}=e;"330000"===t&&setTimeout((()=>{this.asyncStateOptions[0].children=this.t("asyncOptions2")}),500)},afterLeave(){this.leaving[this.curDemo]=!1},getChinaArea(){S().then((e=>{this.chinaArea=e}))}}},[["render",function(e,t,s,a,l,o){const i=x("press-field"),r=x("press-cascader"),u=x("press-popup-plus"),m=x("demo-block");return n(),c("div",{class:"demo-wrap"},[p(m,{title:e.t("basicUsage")},{default:v((()=>[p(i,{value:l.fieldValue.basic,"model-value":l.fieldValue.basic,"is-link":"",readonly:o.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[0]||(t[0]=e=>o.onClick("basic")),onClickInput:t[1]||(t[1]=e=>o.onClick("basic"))},null,8,["value","model-value","readonly","label","placeholder"]),p(u,{show:l.show.basic,round:"",position:"bottom",onAfterLeave:o.afterLeave},{default:v((()=>[l.show.basic||l.leaving.basic?(n(),d(r,{key:0,value:l.cascaderValue.basic,title:e.t("selectArea"),options:e.t("options"),onClose:o.onClose,onFinish:o.onFinish},null,8,["value","title","options","onClose","onFinish"])):h("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),p(m,{title:e.t("chinaAreaData")},{default:v((()=>[p(i,{value:l.fieldValue.chinaArea,"model-value":l.fieldValue.chinaArea,"is-link":"",readonly:o.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[2]||(t[2]=e=>o.onClick("chinaArea")),onClickInput:t[3]||(t[3]=e=>o.onClick("chinaArea"))},null,8,["value","model-value","readonly","label","placeholder"]),p(u,{show:l.show.chinaArea,round:"",position:"bottom",onAfterLeave:o.afterLeave},{default:v((()=>[l.show.chinaArea||l.leaving.chinaArea?(n(),d(r,{key:0,value:l.cascaderValue.chinaArea,title:e.t("selectArea"),options:l.chinaArea,onClose:o.onClose,onFinish:o.onFinish},null,8,["value","title","options","onClose","onFinish"])):h("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),p(m,{title:e.t("customColor")},{default:v((()=>[p(i,{value:l.fieldValue.customColor,"model-value":l.fieldValue.customColor,"is-link":"",readonly:o.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[4]||(t[4]=e=>o.onClick("customColor")),onClickInput:t[5]||(t[5]=e=>o.onClick("customColor"))},null,8,["value","model-value","readonly","label","placeholder"]),p(u,{show:l.show.customColor,round:"",position:"bottom",onAfterLeave:o.afterLeave},{default:v((()=>[l.show.customColor||l.leaving.customColor?(n(),d(r,{key:0,value:l.cascaderValue.customColor,title:e.t("selectArea"),options:e.t("options"),"active-color":"#ee0a24",onClose:o.onClose,onFinish:o.onFinish},null,8,["value","title","options","onClose","onFinish"])):h("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),p(m,{title:e.t("asyncOptions")},{default:v((()=>[p(i,{value:l.fieldValue.asyncOptions,"model-value":l.fieldValue.asyncOptions,"is-link":"",readonly:o.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[6]||(t[6]=e=>o.onClick("asyncOptions")),onClickInput:t[7]||(t[7]=e=>o.onClick("asyncOptions"))},null,8,["value","model-value","readonly","label","placeholder"]),p(u,{show:l.show.asyncOptions,round:"",position:"bottom",onAfterLeave:o.afterLeave},{default:v((()=>[l.show.asyncOptions||l.leaving.asyncOptions?(n(),d(r,{key:0,value:l.cascaderValue.asyncOptions,title:e.t("selectArea"),options:l.asyncStateOptions,onClose:o.onClose,onFinish:o.onFinish,onChange:o.loadDynamicOptions},null,8,["value","title","options","onClose","onFinish","onChange"])):h("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),p(m,{title:e.t("customFieldNames")},{default:v((()=>[p(i,{value:l.fieldValue.customFieldNames,"model-value":l.fieldValue.customFieldNames,"is-link":"",readonly:o.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[8]||(t[8]=e=>o.onClick("customFieldNames")),onClickInput:t[9]||(t[9]=e=>o.onClick("customFieldNames"))},null,8,["value","model-value","readonly","label","placeholder"]),p(u,{show:l.show.customFieldNames,round:"",position:"bottom",onAfterLeave:o.afterLeave},{default:v((()=>[l.show.customFieldNames||l.leaving.customFieldNames?(n(),d(r,{key:0,value:l.cascaderValue.customFieldNames,title:e.t("selectArea"),"field-names":l.fieldNames,options:o.customFieldOptions,onClose:o.onClose,onFinish:o.onFinish,onChange:o.loadDynamicOptions},null,8,["value","title","field-names","options","onClose","onFinish","onChange"])):h("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"])])}]]);export{D as default};
