import{_ as e,aU as t,o as a,c as i,r as s,b as r,P as l,i as d,j as o,e as n,a as u,h,t as g}from"./index-dc5fce78.js";let m=0;function p(e,t,a){return e[t]=a,e}const y=e({i18n:{"zh-CN":{barrage:"弹幕",play:"开始",pause:"暂停",videoBarrage:"模仿视频弹幕",lightweight:"轻量",customizable:"可定制的",mobile:"移动端",library:"组件库"},"en-US":{barrage:"barrage",play:"play",pause:"pause",videoBarrage:"Imitate video barrage",lightweight:"Lightweight",customizable:"Customizable",mobile:"Mobile",library:"Library"}},components:{PressBarrage:e({name:"PressBarrage",mixins:[t({type:[Array],defaultValue:()=>[]})],props:{autoPlay:{type:Boolean,default:!0},rows:{type:[Number,String],default:4},top:{type:[Number,String],default:10},duration:{type:[Number,String],default:4e3},delay:{type:Number,default:300},itemHeight:{type:Number,default:26}},data:()=>({isInitBarrage:!0,barrageItems:[],isPlay:!1,total:0,barrageStyle:"",barrageId:""}),computed:{},watch:{realModelValue:{handler(e,t){this.updateBarrages(e,t)},deep:!0}},mounted(){m+=1,this.barrageId=`press-barrage-${m}`,setTimeout((()=>{this.init()}))},methods:{init(){const{offsetWidth:e}=this.$refs.barrageWrapper;this.barrageStyle=`--move-distance: -${e}px`,(()=>{setTimeout((()=>{this.updateBarrages(this.realModelValue,[])}))})()},play(){this.isPlay=!0,this.barrageItems.forEach((e=>{e.style.animationPlayState="running"}))},pause(){this.isPlay=!1,this.barrageItems.forEach((e=>{e.style.animationPlayState="paused"}))},createBarrageItem(e,t=this.delay){let a={};return a=document.createElement("span"),a.style.animationDuration=`${this.duration}ms`,a.style.animationDelay=`${t}ms`,a.style.animationTimingFunction="linear",a.className="press-barrage__item",a.innerText=String(e),a},appendBarrageItem({id:e,text:t},a){var i;const s=this.createBarrageItem(t,this.isInitBarrage?a*this.delay:void 0);this.autoPlay||!1!==this.isPlay||(s.style.animationPlayState="paused"),null==(i=this.$refs.barrageWrapper)||i.append(s),this.total+=1;let r=this.itemHeight;r=s.offsetHeight;const l=(this.total-1)%+this.rows*r+ +this.top;s.style.top=`${l}px`,s.id=String(e),this.barrageItems.push(s),s.addEventListener("animationend",(()=>{this.emitModelValue([...this.realModelValue].filter((e=>String(e.id)!==s.id)))}))},animationend(e){this.emitModelValue([...this.realModelValue].filter((t=>String(t.id)!==e.id)))},updateBarrages(e,t){const a=new Map(t.map((e=>[e.id,e])));e.forEach(((e,t)=>{a.has(e.id)?a.delete(e.id):this.appendBarrageItem(e,t)})),a.forEach((e=>{const t=this.barrageItems.findIndex((t=>t.id===String(e.id)));t>-1&&(this.barrageItems[t].remove(),this.barrageItems.splice(t,1))})),this.isInitBarrage=!1}}},[["render",function(e,t,l,d,o,n){return a(),i("div",{id:o.barrageId,ref:"barrageWrapper",class:"press-barrage",style:r(o.barrageStyle)},[s(e.$slots,"default",{},void 0,!0)],12,["id"])}],["__scopeId","data-v-cf8e0938"]]),PressButton:l},data(){const e=[{id:100,text:this.t("lightweight")},{id:101,text:this.t("customizable")},{id:102,text:this.t("mobile")},{id:103,text:"Vue"},{id:104,text:this.t("library")},{id:105,text:"PressUI"},{id:106,text:"666"}];return{list:e,videoList:[...e],isPlay:!1}},watch:{isPlay:{handler(e){var t,a;e?null==(t=this.$refs.pressBarrage)||t.play():null==(a=this.$refs.pressBarrage)||a.pause()}}},methods:{add(){p(this,"list",[...this.list,{id:Math.random(),text:"Barrage"}])},videoAdd(){p(this,"videoList",[...this.videoList,{id:Math.random(),text:"Barrage"}])},toggle(){this.isPlay=!this.isPlay}}},[["render",function(e,t,s,r,l,m){const p=n("PressBarrage"),y=n("PressButton"),c=n("demo-block");return a(),i("div",{class:"demo-wrap"},[d(c,{title:e.t("basicUsage")},{default:o((()=>[d(p,{modelValue:l.list,"onUpdate:modelValue":t[0]||(t[0]=e=>l.list=e)},{default:o((()=>[u("div",{class:"video",style:{width:"100%",height:"150px",background:"#f2f3f5"}})])),_:1},8,["modelValue"]),d(y,{type:"primary",size:"small","custom-style":"margin-top: 10px;",onClick:m.add},{default:o((()=>[h(" 弹幕 ")])),_:1},8,["onClick"])])),_:1},8,["title"]),d(c,{title:e.t("videoBarrage")},{default:o((()=>[d(p,{ref:"pressBarrage",modelValue:l.videoList,"onUpdate:modelValue":t[1]||(t[1]=e=>l.videoList=e),"auto-play":!1},{default:o((()=>[u("div",{class:"video",style:{width:"100%",height:"150px",background:"#f2f3f5"}})])),_:1},8,["modelValue"]),u("div",null,[d(y,{type:"primary",size:"small",disabled:!l.isPlay,"custom-style":"margin-top: 10px;margin-right: 10px;",onClick:m.videoAdd},{default:o((()=>[h(" 弹幕 ")])),_:1},8,["disabled","onClick"]),d(y,{type:"default",size:"small","custom-style":"margin-top: 10px;",onClick:m.toggle},{default:o((()=>[h(g(l.isPlay?e.t("pause"):e.t("play")),1)])),_:1},8,["onClick"])])])),_:1},8,["title"])])}]]);export{y as default};
