import{l as e,m as n,n as t,_ as i,p as a,a as o,q as r,o as c,c as s,d as l,w as d,k as p}from"./index-ed1f827b.js";import{t as u,d as h,l as m}from"./dom.93026d3f.js";import{e as g,m as v}from"./msdk.ce2c63eb.js";import"./little-loader.a4dfa947.js";var f={};Object.defineProperty(f,"__esModule",{value:!0});var _,S=u,w=function(){function e(){}return e.setShareObject=function(e){this.shareObject=S.__assign(S.__assign({},this.shareObject),e)},e.setShareUI=function(e){this.shareUiObj=S.__assign(S.__assign({},this.shareUiObj),e)},e}(),b={WX_FRIENDS:1,WX_TIMELINE:2,QQ_FRIENDS:3,QQ_ZONE:4},k=[b.WX_FRIENDS,b.WX_TIMELINE,b.QQ_FRIENDS,b.QQ_ZONE],P=((_={})[b.WX_FRIENDS]="微信好友",_[b.WX_TIMELINE]="微信朋友圈",_[b.QQ_FRIENDS]="QQ好友",_[b.QQ_ZONE]="QQ空间",_),I=Object.keys(b).map((function(e){var n=b[e];return{value:n,label:P[n]}}));f.DEFAULT_API_LIST=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareQZone","updateAppMessageShareData","updateTimelineShareData"],f.DEFAULT_OPEN_TAG_LIST=["wx-open-launch-weapp"],f.DEFAULT_SHARE_ICON="http://ossweb-img.qq.com/images/pmd/igameapp/logo/log_igame_3.0.png",f.DEFAULT_SHOW_TYPE_IN_GAME=k,f.QQ_JS_SDK="https://open.mobile.qq.com/sdk/qqapi.js?_bid=152",f.SHARE_DOM_MAP={SHARE_TIP_DOM_ID:"div_share_tip",SHARE_TIP_STYLE_ID:"div_share_tip_style",SHARE_UI_DOM_ID:"div_share_ui",SHARE_UI_STYLE_ID:"div_share_ui_style"};var y=f.SHARE_TYPE_LIST=I;f.SHARE_TYPE_MAP=b,f.ShareConfig=w;var E={},x={},M={};Object.defineProperty(M,"__esModule",{value:!0});var T=u;function O(e,n){if(void 0===e&&(e=""),void 0===n&&(n=""),!e)return n?void 0:{};var t=e,i=(t=t.substring(e.indexOf("?"))).match(/(\?|&)([^\?&]*=[^\?&#]*)/g);if(!i)return n?void 0:{};var a={};return i.map((function(e){return e.replace(/(\?|&)/g,"")})).forEach((function(e){var n=e.split("="),t=n[0],i=n[1];i&&(a[t]=i)})),n?a[n]:a}function A(e,n,t){void 0===e&&(e=""),void 0===n&&(n={}),void 0===t&&(t=!1);var i=Object.keys(n);if(!e||0===i.length)return e;var a=i.reduce((function(e,t){var i=n[t],a="".concat(t,"=").concat(i);return""!==e?"".concat(e,"&").concat(a):a}),""),o=document.createElement("a")||{};o.href=e;var r=o.origin,c=void 0===r?"":r,s=o.pathname,l=void 0===s?"":s,d=o.hash;if(!c)return e;var p=(void 0===d?"":d).match(/^#([^?]*)/),u=null==p?void 0:p[1],h="";if(!t){var m=e.includes("?")&&!e.includes("#");!1!==t&&m||(h="#".concat(u||"/"))}return"".concat(c).concat(l).concat(h,"?").concat(a)}function D(e,n,t){void 0===t&&(t=!1);var i=O(e),a={};return Object.keys(i).forEach((function(e){n.includes(e)&&(a[e]=i[e])})),A(e,a,t)}M.extendUrlParams=function(e,n,t){void 0===t&&(t=!1);var i=O(e)||{};return A(e,T.__assign(T.__assign({},i),n),t)},M.filterUrlParams=function(e){void 0===e&&(e={url:window.location.href,limit:1e3,keepKey:[]});var n=e.url,t=void 0===n?window.location.href:n,i=e.limit,a=void 0===i?1e3:i,o=e.keepKey,r=void 0===o?[]:o,c=e.forceHistoryMode,s=t;return s.length<=a?s:D(s,r,c)},M.formatUrlParams=A,M.keepUrlParams=D,M.removeUrlParams=function(e,n,t){void 0===t&&(t=!1);var i=O(e),a={};return Object.keys(i).forEach((function(e){n.includes(e)||(a[e]=i[e])})),A(e,a,t)},M.resolveUrlParams=O;var C={};Object.defineProperty(C,"__esModule",{value:!0});var L=h,U="customDialogId";function W(e){var n=e.styleId,t=e.styleContent,i=e.dialogId,a=e.dialogContent;L.insertStyle({id:n,content:t}),L.insertHtml({id:i,content:a})}C.initCustomDialog=function(e){var n=e.title,t=e.content,i=e.confirmText,a=e.cancelText,o=e.styleId,r=void 0===o?"customDialogStyle":o,c=e.dialogId,s=void 0===c?U:c;W({styleId:r,styleContent:"\n  .tip-toc-dialog-wrap,.tip-toc-operating-layer,.tip-toc-sharetips{position:fixed;top:0;left:0;z-index:9999;width:100%;height:100%;background:rgba(0,0,0,.8)}\n.tip-toc-dialog,.tip-toc-sharedialog,.tip-toc-tipsdialog{position:fixed;top:50%;left:50%;z-index:10000;background:#fff;transform:translate(-50%,-50%)}\n.tip-toc-dialog{padding-top:.32rem;width:5.6rem;border-radius:4px}\n.tip-toc-tipsdialog{padding-top:.48rem;width:5rem;border-radius:4px}\n.tip-toc-sharedialog{width:6.3rem;border-radius:2px}\n.tip-toc-dialog-close{position:absolute;top:.16rem;right:.16rem;display:block;width:.5rem;height:.5rem;background:url(https://image-1251917893.file.myqcloud.com/TIP_GameSystem_2020/toB/icon/ico-close.png) center center no-repeat;background-size:.3rem .3rem}\n.tip-toc-dialog-title{color:#4a4a4a;text-align:center;font-weight:700;font-size:.32rem;line-height:.44rem}\n.tip-toc-dialog-texttips{margin:.16rem auto -.36rem;color:#9b9b9b;text-align:center;font-size:.24rem;line-height:.34rem}\n.tip-toc-dialog-content{padding:.12rem .6rem .24rem}\n.tip-toc-content-tips-normal,.tip-toc-content-tips-warn{text-align:center;font-size:.28rem;line-height:.4rem}\n.tip-toc-content-tips-normal{color:#999}\n.tip-toc-dialogtextbtn{display:flex;border-top:1px solid #d8d8d8}\n.tip-textbtn-cancel,.tip-textbtn-primary{display:block;width:100%;height:.88rem;text-align:center;font-size:.28rem;line-height:.88rem}\n.tip-textbtn-primary{color:#d49b38}\n.tip-textbtn-cancel{border-right:1px solid #d8d8d8;color:#4a4a4a}\n  ",dialogId:s,dialogContent:'\n  <div\n    class="tip-toc-dialog-wrap"\n    id="'.concat(s,'"\n    onclick="document.getElementById(\'').concat(s,'\').style.display=\'none\';"\n  >\n  <div class="tip-toc-tipsdialog">\n    <h4 class="tip-toc-dialog-title">\n      ').concat(n,'\n    </h4>\n    <div class="tip-toc-dialog-content">\n      <p class="tip-toc-content-tips-normal">\n        ').concat(t,'\n      </p>\n    </div>\n    <div class="tip-toc-dialogtextbtn">\n     ').concat(a?'\n      <a\n        id="cancel_btn"\n        class="tip-textbtn-primary"\n        style="color: #9b9b9b;border-right: 1px solid #d8d8d8;"\n        onclick="document.getElementById(\''.concat(s,"').style.display='none';\"\n        >").concat(a,"</a>\n     "):"",'\n      <a\n        id="confirm_btn"\n        class="tip-textbtn-primary"\n        onclick="document.getElementById(\'').concat(s,"').style.display='none';\"\n      >\n      ").concat(i,"\n      </a>\n    </div>\n  </div>\n</div>\n  ")})},C.initCustomDom=W,C.showCustomDialog=function(e){void 0===e&&(e=U);var n=document.getElementById(e);n&&(n.style.display="block")};var Q={},j={};Object.defineProperty(j,"__esModule",{value:!0});var N=m;function R(e){var n,t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.dpi=window.devicePixelRatio,null===(n=t.getContext("2d"))||void 0===n||n.drawImage(e,0,0,e.width,e.height),t}j.convertDomToImage=function(e,n,t){var i={useCORS:!0,backgroundColor:"transparent"},a=document.getElementById(e);if(a){var o=document.createElement("canvas"),r=a.offsetWidth,c=a.offsetHeight;o.width=3*r,o.height=3*c,i.scale=3,i.canvas=o,i.width=r,i.height=c}N.loadJS("https://image-1251917893.file.myqcloud.com/commjs/html2canvas.min.js").then((function(){var a=document.getElementById(e);a&&(null===window||void 0===window||window.html2canvas(a,i).then((function(e){var i=e.toDataURL("image/png"),a=document.getElementById(n);a&&(a.src=i),t&&"function"==typeof t&&t(i)})).catch((function(e){console.warn("[convertDomToImage] error: ",e)})))}))},j.convertImageToCanvas=R;var H=j.urlToBase64=function(e){return new Promise((function(n){var t=new Image;e=-1===e.indexOf("?")?"".concat(e,"?t=").concat((new Date).getTime()):"".concat(e,"&t=").concat((new Date).getTime()),t.setAttribute("crossOrigin","anonymous"),t.src=e,t.onload=function(){var e=R(t).toDataURL("image/png");n(e)},t.onerror=function(){n("")}}))},B={};Object.defineProperty(B,"__esModule",{value:!0}),B.msdkShareV5=function(e,n){var t,i,a,o={1:{method:"sendMsgWebView",channel:"WeChat"},2:{method:"shareWebView",channel:"WeChat"},3:{method:"sendMsgWebView",channel:"QQ"},4:{method:"shareWebView",channel:"QQ"}},r=JSON.stringify({MsdkMethod:o[e].method,actionReport:"MSG_INVITE",channel:o[e].channel,desc:n.desc,imagePath:n.imgUrl||n.icon,link:n.url||n.link,messageExt:"messageExt",tailLogo:"WECHAT_SNS_JUMP_APP",thumbPath:n.imgUrl||n.icon,title:n.title,type:10001,user:""});t=r,a=function(e){e.init((function(e,n){console.log("JS got a message",e);var t={"Javascript Responds":"Wee!"};console.log("JS responding with",t),n(t)})),e.registerHandler("msdkNativeCallback",(function(e){var n;null===(n=window.msdkNativeCallback)||void 0===n||n.call(window,e)})),i=e.callHandler},(null===window||void 0===window?void 0:window.WebViewJavascriptBridge)?a(window.WebViewJavascriptBridge):null===document||void 0===document||document.addEventListener("WebViewJavascriptBridgeReady",(function(){a(window.WebViewJavascriptBridge)}),!1),navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?i("MSDKCall",t,null):t.indexOf("nativeCallJS")>-1?alert(t):prompt(t)};var G={};Object.defineProperty(G,"__esModule",{value:!0});var q=f,F=C;var z=G.calBase64Size=function(e){var n=e.replace("data:image/png;base64,",""),t=n.indexOf("=");n.indexOf("=")>0&&(n=n.substring(0,t));var i=n.length;return(parseInt("".concat(i-i/8*2),10)/1024).toFixed(2)};G.initCommShareTip=function(){var e="",n=q.ShareConfig.shareObject,t=n.isWzydShare,i=n.wzydShareText,a=void 0===i?"点击“...”分享链接":i,o="\n  .tip-toc-sharetips {position: fixed;z-index: 9999;height: 100%;width: 100%;left: 0;top: 0;}\n  ";e="\n    ".concat(o,t?"\n    .tip-toc-sharetips {background: rgba(0,0,0,0.5);}\n    .tip-toc-share-arrow{background: url(\"https://image-1251917893.file.myqcloud.com/Esports/user/img/share-tip-arrow.png\") no-repeat right center;background-size: .85rem .55rem;width: 100%;height: .55rem;margin-top: .16rem;}\n    .tip-toc-share-box{display: flex;position: fixed;top: .66rem;right: .62rem;}\n    .tip-toc-sharetips .share-tip {height: .93rem;width: auto;background: url(https://image-1251917893.file.myqcloud.com/Esports/user/img/share-tip-bg.png) no-repeat;background-size: 100% .93rem;color: #fff;font-size: .28rem;position: relative;margin-left: .89rem;}\n    .tip-toc-sharetips .share-tip>span{display: block;max-width: 6rem;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;word-break: break-all;line-height: .93rem;}\n    .tip-toc-sharetips .share-tip::before,.tip-toc-sharetips .share-tip::after{content: '';position: absolute;top: 0;height: .93rem;background-size: 100%;}\n    .tip-toc-sharetips .share-tip::before{left: -.89rem;width: .89rem;background: url(https://image-1251917893.file.myqcloud.com/Esports/user/img/share-tip-left.png) no-repeat;}\n    .tip-toc-sharetips .share-tip::after{right: -.61rem;width: .62rem;background: url(https://image-1251917893.file.myqcloud.com/Esports/user/img/share-tip-right.png) no-repeat;}\n  ":"\n    .tip-toc-sharetips {background: rgba(0,0,0,0.7);}\n    .tip-toc-sharetips__arrow {position: absolute;top: .58rem;right: .58rem;width: 1.58rem;height: 1.52rem;background: url(https://image-1251917893.file.myqcloud.com/TIP_GameSystem_2020/toC/icon/share-arrow-2.png) center no-repeat;background-size: 1.58rem 1.52rem;}\n    .tip-toc-sharetips__tip {padding: 2.1rem 2.2rem 0.1rem 0.2rem;text-align: right;font-size: .36rem;height: 2rem;color: #fff;}\n    ");var r="";r=t?'<div class="tip-toc-sharetips"><div class="tip-toc-share-arrow" /><div class="tip-toc-share-box"><div class="share-tip"><span>'.concat(a,"</span></div></div></div>"):'<div class="tip-toc-sharetips"><div class="tip-toc-sharetips__arrow"></div><p class="tip-toc-sharetips__tip">点此分享</p></div>',F.initCustomDom({styleId:q.SHARE_DOM_MAP.SHARE_TIP_STYLE_ID,styleContent:e,dialogId:q.SHARE_DOM_MAP.SHARE_TIP_DOM_ID,dialogContent:r});var c=document.getElementById(q.SHARE_DOM_MAP.SHARE_TIP_DOM_ID);null==c||c.addEventListener("click",(function(){c.style.display="none"}),!1)},G.initCommShareUI=function(e,n){void 0===n&&(n=q.DEFAULT_SHOW_TYPE_IN_GAME);var t=function(e){return n.indexOf(e)>-1},i='\n  <div class="share-dialog-login">\n    <a href="javascript:;" class="share-dialog-close" onclick="document.getElementById(\''.concat(q.SHARE_DOM_MAP.SHARE_UI_DOM_ID,"').style.display='none';\">关闭</a>\n    <div class=\"share-choose-login\">\n      ").concat(t(q.SHARE_TYPE_MAP.WX_TIMELINE)?'<a href="javascript:;" onclick="javascript:'.concat(e,"(").concat(q.SHARE_TYPE_MAP.WX_TIMELINE,');">\n        <span class="share-type share-type-1 share-type--wx-friends"></span>\n        <span class="share-public-text">朋友圈</span>\n      </a>'):"","\n      ").concat(t(q.SHARE_TYPE_MAP.WX_FRIENDS)?'<a href="javascript:;" onclick="javascript:'.concat(e,"(").concat(q.SHARE_TYPE_MAP.WX_FRIENDS,');">\n        <span class="share-type share-type-2 share-type--wx-timeline"></span>\n        <span class="share-public-text">微信好友</span>\n      </a>'):"","\n      ").concat(t(q.SHARE_TYPE_MAP.QQ_FRIENDS)?'<a href="javascript:;" onclick="javascript:'.concat(e,"(").concat(q.SHARE_TYPE_MAP.QQ_FRIENDS,');">\n        <span class="share-type share-type-3 share-type--qq-friends"></span>\n        <span class="share-public-text">QQ好友</span>\n      </a>'):"","\n      ").concat(t(q.SHARE_TYPE_MAP.QQ_ZONE)?'<a href="javascript:;" onclick="javascript:'.concat(e,"(").concat(q.SHARE_TYPE_MAP.QQ_ZONE,');">\n        <span class="share-type share-type-4 share-type--qq-zone"></span>\n        <span class="share-public-text">QQ空间</span>\n      </a>'):"",'\n    </div>\n  </div>\n  <div class="share-layer" onclick="document.getElementById(\'').concat(q.SHARE_DOM_MAP.SHARE_UI_DOM_ID,"').style.display='none';\"></div>\n  ");F.initCustomDom({styleId:q.SHARE_DOM_MAP.SHARE_UI_STYLE_ID,styleContent:"\n  .share-dialog-login{ padding:30px 20px; position:fixed; left:0; right:0; bottom:0;background:#222222; z-index:2001}  .share-choose-login {width:100%;margin:20px auto 0;text-align: center;font-size:0;}  .share-choose-login a {display:inline-block;vertical-align:middle;width:25%;}  .share-type{ width:45px; height:45px; display:block; margin:0 auto;  }  .share-type-1{background:url(//game.gtimg.cn/images/sy/2016/miniweb/ingame/commsrc/shareicon.png) no-repeat;background-size:auto 100%;}  .share-type-2{background:url(//game.gtimg.cn/images/sy/2016/miniweb/ingame/commsrc/shareicon.png) -45px 0 no-repeat;background-size:auto 100%;}  .share-type-3{background:url(//game.gtimg.cn/images/sy/2016/miniweb/ingame/commsrc/shareicon.png) -90px 0 no-repeat;background-size:auto 100%;}  .share-type-4{background:url(//game.gtimg.cn/images/sy/2016/miniweb/ingame/commsrc/shareicon.png) -135px 0 no-repeat;background-size:auto 100%;}  .share-public-text {display: block;color: #aaa;font-size:14px;line-height:20px;padding-top:6px;}  .share-dialog-close{ width:25px; height:25px; display:block; position:absolute; right:10px; top:10px; background:url(//game.gtimg.cn/images/user/cp/a20170922tipYYB/close-b.png) center center no-repeat; background-size:15px 15px; text-indent:-1000em; overflow:hidden}  .share-layer{ width:100%; height:100%; position:fixed; left:0; top:0; z-index:2000; background:rgba(0,0,0,0.5) }\n  ",dialogId:q.SHARE_DOM_MAP.SHARE_UI_DOM_ID,dialogContent:i})},G.showCommShareTip=function(){var e=document.getElementById(q.SHARE_DOM_MAP.SHARE_TIP_DOM_ID);e&&(e.style.display="block")},G.showCommShareUI=function(){var e=document.getElementById(q.SHARE_DOM_MAP.SHARE_UI_DOM_ID);e&&(e.style.display="block")},Object.defineProperty(Q,"__esModule",{value:!0});var Y=u,J=g,X=j,V=v,K=B,Z=f,$=G;function ee(e){void 0===window.msdkShare?V.callJsBrowserAdapter().then((function(){window.msdkShare(e)})):window.msdkShare(e)}function ne(e){var n,t,i=e.funcName,a=e.scene,o=e.title,r=e.desc,c=e.url,s=e.imgUrl;void 0===window.msdkShare?V.callJsBrowserAdapter().then((function(){var e,n;null===(n=null===(e=window.customBrowserInterface)||void 0===e?void 0:e[i])||void 0===n||n.call(e,a,o,r,c,s)})):null===(t=null===(n=window.customBrowserInterface)||void 0===n?void 0:n[i])||void 0===t||t.call(n,a,o,r,c,s)}function te(e){var n=e.failedCallback,t=e.getMiniProgramOpenLink;void 0!==t?t().then((function(e){(null==e?void 0:e.open_link)?window.location.href=e.open_link:null==n||n()})).catch((function(){null==n||n()})):null==n||n()}Q.initInGameShare=function(e){var n=e.shareObject,t=e.getMiniProgramOpenLink,i=n.showTypeInGame,a=void 0===i?Z.DEFAULT_SHOW_TYPE_IN_GAME:i;$.initCommShareUI("slugSDKShareDelegate",a),Z.ShareConfig.setShareUI({openShareUI:function(){$.showCommShareUI()}}),window.slugSDKShareDelegate=function(e){var i;switch(null===(i=n.callback)||void 0===i||i.call(n),e){case Z.SHARE_TYPE_MAP.WX_FRIENDS:t?te({failedCallback:function(){ne({funcName:"sendToWeixinWithUrl",scene:2,title:n.title,desc:n.desc,url:n.link,imgUrl:n.icon})},getMiniProgramOpenLink:t}):ne({funcName:"sendToWeixinWithUrl",scene:2,title:n.title,desc:n.desc,url:n.link,imgUrl:n.icon});break;case Z.SHARE_TYPE_MAP.WX_TIMELINE:ne({funcName:"sendToWeixinWithUrl",scene:1,title:n.title,desc:n.desc,url:n.link,imgUrl:n.icon});break;case Z.SHARE_TYPE_MAP.QQ_FRIENDS:ne({funcName:"sendToQQ",scene:2,title:n.title,desc:n.desc,url:n.link,imgUrl:n.icon});break;case Z.SHARE_TYPE_MAP.QQ_ZONE:ne({funcName:"sendToQQ",scene:1,title:n.title,desc:n.desc,url:n.link,imgUrl:n.icon})}}},Q.initMsdkShare=function(e){var n=e.getMiniProgramOpenLink,t=e.shareObject,i=t.showTypeInGame,a=void 0===i?Z.DEFAULT_SHOW_TYPE_IN_GAME:i;$.initCommShareUI("msdkShareDelegate",a),Z.ShareConfig.setShareUI({openShareUI:function(){$.showCommShareUI()}}),J.initEnv().isMsdkV5?window.msdkShareDelegate=function(e){if(1!==e)try{K.msdkShareV5(e,t)}catch(i){console.log("err",i)}else te({failedCallback:function(){K.msdkShareV5(e,t)},getMiniProgramOpenLink:n})}:window.msdkShareDelegate=function(e){var i;return Y.__awaiter(this,void 0,void 0,(function(){var a,o,r,c,s,l,d,p;return Y.__generator(this,(function(u){switch(u.label){case 0:return null===(i=t.callback)||void 0===i||i.call(t),a=e||0,[4,X.urlToBase64(t.icon)];case 1:if(o=u.sent(),r=+$.calBase64Size(o),console.log("msdkShareDelegate imageDataSize : ",r),c=t.title.replace(/\n|\r|"|\\/g,""),s=t.desc.replace(/\n|\r|"|\\/g,""),(p={})[Z.SHARE_TYPE_MAP.WX_FRIENDS]={MsdkMethod:"WGSendToWeiXinWithUrl",scene:"0",title:c,desc:s,url:t.link,mediaTagName:"MSG_INVITE",messageExt:"title"},p[Z.SHARE_TYPE_MAP.WX_TIMELINE]={MsdkMethod:"WGSendToWeiXinWithUrl",scene:"1",title:c,desc:s,url:t.link,mediaTagName:"MSG_INVITE",messageExt:"title"},p[Z.SHARE_TYPE_MAP.QQ_FRIENDS]={MsdkMethod:"WGSendToQQ",scene:"2",title:c,desc:s,url:t.link},p[Z.SHARE_TYPE_MAP.QQ_ZONE]={MsdkMethod:"WGSendToQQ",scene:"1",title:c,desc:s,url:t.link},l=p,Object.keys(l).forEach((function(e){var n=l[e];l[e]=JSON.stringify(Y.__assign(Y.__assign({},n),{imgUrl:t.icon}))})),void 0===l[a])return[2,!1];if(d=l[a],a===Z.SHARE_TYPE_MAP.WX_FRIENDS&&n)te({failedCallback:function(){ee(d)},getMiniProgramOpenLink:n});else try{ee(d)}catch(h){throw console.log("e",h),h}return[2]}}))}))}};var ie={},ae={},oe={};Object.defineProperty(oe,"__esModule",{value:!0});oe.WX_JS_SDK="https://image-1251917893.file.myqcloud.com/commjs/jweixin-1.6.0.js",Object.defineProperty(ae,"__esModule",{value:!0});var re=oe,ce=m;ae.configWx=function(e){var n=e.apiList,t=e.openTagList,i=e.getWxSignaturePromise;return new Promise((function(e,a){ce.loadJS(re.WX_JS_SDK).then((function(){(function(e){var n=e.apiList,t=e.openTagList,i=e.getWxSignaturePromise;return new Promise((function(e,a){i().then((function(i){var o;void 0===i&&(i={}),null===(o=null===window||void 0===window?void 0:window.wx)||void 0===o||o.config({beta:!0,debug:!1,appId:i.wxappid,timestamp:i.timestamp,nonceStr:i.noncestr,signature:i.signature,jsApiList:n,openTagList:t}),window.wx.ready((function(){e(window.wx)})),window.wx.error((function(e){console.warn("wx config error : ",e),a(e)}))})).catch((function(e){a(e),console.log("get_share_cfg error : ",e)}))}))})({apiList:n,openTagList:t,getWxSignaturePromise:i}).then((function(n){e(n)})).catch((function(e){console.log("configWx error : ",e),a(e)}))}))}))},Object.defineProperty(ie,"__esModule",{value:!0});var se=m,le=ae,de=oe,pe=f,ue=G;ie.hideQQShareBtn=function(){se.loadJS("QQ_JS_SDK").then((function(){var e,n,t;null===(t=null===(n=null===(e=null===window||void 0===window?void 0:window.mqq)||void 0===e?void 0:e.ui)||void 0===n?void 0:n.setWebViewBehavior)||void 0===t||t.call(n,{actionButton:0})}))},ie.hideWeixinShareBtn=function(){var e=pe.ShareConfig.shareObject.getWxSignaturePromise;e&&le.configWx({apiList:["checkJsApi","hideMenuItems"],getWxSignaturePromise:e}).then((function(){var e,n=window.wx;null===(e=null==n?void 0:n.ready)||void 0===e||e.call(n,(function(){n.hideMenuItems({menuList:["menuItem:share:qq","menuItem:share:QZone","menuItem:share:appMessage","menuItem:share:timeline","menuItem:share:wework"]})}))})).catch((function(e){console.log("[hideShareBtn] error : ",e)}))},ie.initMiniProgramShare=function(e){var n=e.shareObject;ue.initCommShareTip(),se.loadJS(de.WX_JS_SDK).then((function(){window.wx.miniProgram.postMessage({data:{cmd:"share",shareParams:n}})}))},ie.initQQShare=function(e){var n=e.shareObject;ue.initCommShareTip(),se.loadJS(pe.QQ_JS_SDK).then((function(){var e,t;null===(t=null===(e=null===window||void 0===window?void 0:window.mqq)||void 0===e?void 0:e.ui)||void 0===t||t.setOnShareHandler((function(e){var t,i;if([0,1,2,3,11].indexOf(+e)>-1){var a={title:n.title,desc:n.desc,share_type:e,share_url:n.link,image_url:n.icon,back:!0,uinType:0};null===(i=null===(t=null===window||void 0===window?void 0:window.mqq)||void 0===t?void 0:t.ui)||void 0===i||i.shareMessage(a,(function(){var e;null===(e=null==n?void 0:n.callback)||void 0===e||e.call(n)}))}}))}))},ie.initWeixinShare=function(e){var n=e.shareObject,t=e.getWxSignaturePromise,i=e.apiList,a=void 0===i?pe.DEFAULT_API_LIST:i,o=e.openTagList,r=void 0===o?pe.DEFAULT_OPEN_TAG_LIST:o;ue.initCommShareTip(),le.configWx({apiList:a,openTagList:r,getWxSignaturePromise:t}).then((function(){var e,t,i,a,o=window.wx,r={title:n.title,desc:n.desc,link:n.link,imgUrl:n.icon,type:"",dataUrl:"",success:function(e){var t;null===(t=n.callback)||void 0===t||t.call(n),console.warn("success",e)},cancel:function(){},fail:function(e){console.warn("fail",e)}};-1===r.link.indexOf("?")?r.link="".concat(r.link,"?sharect=").concat((new Date).getTime()):-1===r.link.indexOf("sharect")&&(r.link="".concat(r.link,"&sharect=").concat((new Date).getTime())),null===(e=null==o?void 0:o.onMenuShareTimeline)||void 0===e||e.call(o,r),null===(t=null==o?void 0:o.onMenuShareAppMessage)||void 0===t||t.call(o,r),null===(i=null==o?void 0:o.onMenuShareQQ)||void 0===i||i.call(o,r),null===(a=null==o?void 0:o.onMenuShareQZone)||void 0===a||a.call(o,r),null==o||o.ready((function(){var e,n;null===(e=null==o?void 0:o.updateAppMessageShareData)||void 0===e||e.call(o,r),console.warn(r),null===(n=null==o?void 0:o.updateTimelineShareData)||void 0===n||n.call(o,r)}))})).catch((function(e){console.log("initWeixinShare error : ",e)}))};var he={};Object.defineProperty(he,"__esModule",{value:!0});var me=f;he.hidePvpShareBtn=function(){var e=me.ShareConfig.shareObject.pvpInvoke;null==e||e("setTitleButtons",{type:0,title:"",button:""})},he.initGHelperShare=function(e){var n=e.shareObject;function t(){me.ShareConfig.setShareUI({openShareUI:function(){try{null===GameHelper||void 0===GameHelper||GameHelper.shareWebPage(n.title,n.desc,n.icon,n.link,n.type)}catch(e){console.log(e)}}})}"undefined"==typeof GameHelper&&document.addEventListener?document.addEventListener("GameHelperReady",t,!1):t()},he.initPvpShare=function(e){var n,t,i=e.shareObject,a=i.pvpInvoke;if(a){var o={type:"1",share_url:i.link,image_url:i.icon,title:i.title,desc:i.desc,miniprogram_url:i.miniprogram_link};window.shareCallBack=function(){var e;null===(e=i.callback)||void 0===e||e.call(i)},window.setTitleButtonsCallback=function(){a("openShare",o,"shareCallBack")};var r={title:null===(t=null===(n=document.getElementsByTagName("title"))||void 0===n?void 0:n[0])||void 0===t?void 0:t.innerText,button:"分享"};a("setTitleButtons",r,"setTitleButtonsCallback")}},he.initTipShare=function(e){var n,t,i=e.shareObject,a=i.tipInvoke;if(a){var o={type:"1",share_url:i.link,image_url:i.icon,title:i.title,desc:i.desc};window.shareCallBack=function(){var e;null===(e=i.callback)||void 0===e||e.call(i)},window.setTitleButtonsCallback=function(){a("openShare",o,"shareCallBack")};var r={title:null===(t=null===(n=document.getElementsByTagName("title"))||void 0===n?void 0:n[0])||void 0===t?void 0:t.innerText,button:"分享"};a("setTitleButtons",r,"setTitleButtonsCallback")}},Object.defineProperty(x,"__esModule",{value:!0});var ge=g,ve=M,fe=C,_e=Q,Se=ie,we=he,be=G,ke=f;x.hideShareBtn=function(){var e=ge.initEnv();e.isQQ?Se.hideQQShareBtn():e.isMiniProgram||(e.isWeixin?Se.hideWeixinShareBtn():e.isPvpApp&&we.hidePvpShareBtn())},x.initShare=function(e){var n,t,i;void 0===e&&(e={getWxSignaturePromise:function(){return Promise.resolve({})},getMiniProgramOpenLink:function(){return Promise.resolve({})}});var a=e;a.title=a.title||(null===(t=null===(n=document.getElementsByTagName("title"))||void 0===n?void 0:n[0])||void 0===t?void 0:t.innerText),a.desc=a.desc||a.title,a.icon=a.icon||ke.DEFAULT_SHARE_ICON,a.type=a.type||null,a.path=a.path||null,a.forceHistoryMode=a.forceHistoryMode||null,(null===(i=a.showTypeInGame)||void 0===i?void 0:i.length)||(a.showTypeInGame=ke.DEFAULT_SHOW_TYPE_IN_GAME);var o=a.link||window.location.href;a.link=ve.removeUrlParams(o,["reporttk"]),a.wzydShareText=a.wzydShareText||"点击“...”分享链接",ke.ShareConfig.setShareObject(a);for(var r=a.getWxSignaturePromise,c=void 0===r?function(){return Promise.resolve({})}:r,s=a.getMiniProgramOpenLink,l=void 0===s?function(){return Promise.resolve({})}:s,d=ke.ShareConfig.shareObject,p=ge.initEnv(),u=0,h=[{condition:p.isMsdk,callback:function(){_e.initMsdkShare({getMiniProgramOpenLink:l,shareObject:d})}},{condition:p.isGHelper,callback:function(){we.initGHelperShare({shareObject:d})}},{condition:p.isQQ,callback:function(){Se.initQQShare({shareObject:d})}},{condition:p.isMiniProgram,callback:function(){Se.initMiniProgramShare({shareObject:d})}},{condition:p.isWeixin,callback:function(){Se.initWeixinShare({shareObject:d,getWxSignaturePromise:c})}},{condition:p.isPvpApp,callback:function(){we.initPvpShare({shareObject:d})}},{condition:p.isTipApp,callback:function(){we.initTipShare({shareObject:d})}},{condition:p.isSlugSdk,callback:function(){_e.initInGameShare({shareObject:d,getMiniProgramOpenLink:l})}}];u<h.length;u++){var m=h[u];if(m.condition){m.callback();break}}},x.openShareUI=function(){var e,n=ke.ShareConfig.shareUiObj,t=ge.initEnv();t.isInGame||t.isGHelper?null===(e=null==n?void 0:n.openShareUI)||void 0===e||e.call(n):t.isQQ||t.isWeixin?be.showCommShareTip():function(){var e,n=ke.ShareConfig.shareObject;"function"==typeof(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.share)?window.navigator.share({url:n.link,text:n.title,title:n.title}).then((function(){console.log("NavigatorShare success")})).catch((function(){console.log("NavigatorShare fail")})):(fe.initCustomDialog({title:"温馨提示",content:"请复制链接到微信或手机QQ内打开参与活动",confirmText:"我知道了"}),fe.showCustomDialog())}()};var Pe={};function Ie(){var e=t();return e[e.length-1]}Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.getCurrentPage=Ie,Pe.initShareMp=function(e){var n=Ie();n&&(n.onShareAppMessage=function(){return{title:"".concat(e.title)||"",path:e.mpPath||e.path||"",imageUrl:e.mpImageUrl||e.imageUrl||e.icon||""}})},Pe.openShareUIMp=function(e,n){void 0===e&&(e='点击右上角"..."分享'),void 0===n&&(n=3e3),uni.showToast({title:e,icon:"none",duration:n,success:function(){},fail:function(){}})},Object.defineProperty(E,"__esModule",{value:!0});var ye=x,Ee=Pe,xe=E.initShare=ye.initShare,Me=E.openShareUI=ye.openShareUI;function Te(){return new Promise((e=>{const n=encodeURIComponent(encodeURIComponent(`${window.location.protocol}//${window.location.host}${window.location.pathname}${window.location.search}`));uni.request({url:`https://m.igame.qq.com/pvp/share/get_share_cfg?referpath=${n}&tstamp=${Date.now()}`,method:"POST",success:n=>{e(n.data||{}),console.log("[getWxSignaturePromise]",n.data)}})}))}E.initShareMp=Ee.initShareMp,E.openShareUIMp=Ee.openShareUIMp;const Oe=5;function Ae(){return new Promise((e=>{uni.request({method:"POST",url:"https://a.igame.qq.com/merc.merccgi.accountBind.accountBind/GetMiniProgramOpenLink",data:{appid:"wx94057b049312ffec",path:"/convert-cross/views/x5m/index/index",param_data:"brandid=b1689820502&configid=gGVLomFG&inviteid=ILG6f2cfa387b694e6077f52edc0c302322&shareId=o5P-Ojory9Xh7lkreheBWF7yrFv4&adtag=share&gid=507",jump_type:Oe},success:n=>{e(n.data||{}),console.log("[getMiniProgramOpenLink]",n.data)}})}))}const De=function(e,n,t){!function(e,n,t=!1){let i;for(i in n)(n.hasOwnProperty(i)&&!(i in e)||t)&&(e[i]=n[i])}(n,{callback:t}),function(e,n){const t=`igameapp://jsapi/${e}?p=${encodeURIComponent(JSON.stringify(n)||"")}`,i=document.createElement("iframe");i.setAttribute("width","0"),i.setAttribute("height","0"),i.setAttribute("style","display: none;"),document.body.appendChild(i),i.src=t,setTimeout((()=>{document.body.removeChild(i)}),0)}(e,n)};const Ce=i({i18n:{"zh-CN":{custom:"自定义",share:"分享"},"en-US":{custom:"Custom",share:"Share"}},components:{PressPopupCell:a,PressCell:o},data:()=>({FUNCTIONAL_ID_MAP:r,params:{showTypeInGame:[1,2,3,4],useOpenLink:!0},shareParams:{title:"PressUI 跨端组件库",desc:"PressUI可用于uni-app项目、基于Vue的普通H5和PC项目",icon:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press%2Fimg%2Fshare-sheet-wechat.png",mpImageUrl:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press/img/press-ui-avatar-wx-share.png",link:"https://h5.igame.qq.com/pmd-mobile.support.press-ui.press-ui-demo/#/pages/launch-app/launch-app?show=true",mpPath:"/pages/press/protocol/protocol?a=1&b=2&c=3&d=china&e=dd123ff",getWxSignaturePromise:Te,getMiniProgramOpenLink:Ae,pvpInvoke:De}}),created(){},mounted(){this.onInitShare()},methods:{onInitShare(){xe(this.shareParams)},onCustom(){!function({context:t,callback:i,params:a={}}){var o;e({context:t,title:"自定义设置",closeIcon:!0,cellList:[{label:"游戏内使用 open link",type:"switch",open:a.useOpenLink,click:({context:e})=>{e.closeDialog(),t.onGTip("设置成功"),"function"==typeof i.changeParams&&i.changeParams.call(t,{useOpenLink:!a.useOpenLink})}},{label:"游戏内展示类型",value:(o=a.showTypeInGame,o.length===y.length?"全部":y.filter((e=>(o||[]).indexOf(e.value)>-1)).map((e=>e.label)).join(", ")),click:({context:e})=>{e.closeDialog(),n({context:t,title:"游戏内展示类型",button:"确定",closeIcon:!0,asyncConfirm:({checkedIndexList:e})=>(console.log("[checkedIndexList]...",e),!!(null==e?void 0:e.length)||(t.onGTip("必须选择一种类型"),!1)),cellList:y.map((e=>({...e,checked:a.showTypeInGame.indexOf(e.value)>-1,type:"checkbox"})))}).then((e=>{var n;if(console.log("[showPopupCell2] res",e),null==(n=null==e?void 0:e.context)||n.closeDialog(),t.onGTip("设置成功"),"function"==typeof i.changeParams){const n=y.filter(((n,t)=>(e.checkedIndexList||[]).indexOf(t)>-1)).map((e=>e.value));console.log("[selectList]: ",n),i.changeParams.call(t,{showTypeInGame:n})}})).catch((e=>{var n;console.log("[showPopupCell] err",e),null==(n=null==e?void 0:e.context)||n.closeDialog()}))}}]}).then((e=>{const{context:n={}}=e||{};n.closeDialog()})).catch((e=>{const{context:n={}}=e||{};console.log("[showCustomPopup] err",e),n.closeDialog()}))}({context:this,callback:{changeParams:this.changeParams},params:this.params})},changeParams(e){this.params={...this.params,...e||{}};const{showTypeInGame:n,useOpenLink:t}=this.params;t?this.shareParams.getMiniProgramOpenLink=Ae:delete this.shareParams.getMiniProgramOpenLink,this.shareParams.showTypeInGame=n,this.onInitShare()},onShare(){Me()},async onGetImgSize(){const e=await H("https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article%2F2023%2F8%2Fqq-btn.png"),n=z(e);console.log("[onGetImgSize] size",n),console.log("[onGetImgSize] data",e)}}},[["render",function(e,n,t,i,a,o){const r=p("press-cell"),u=p("demo-block"),h=p("PressPopupCell");return c(),s("div",{class:"demo-wrap"},[l(u,{title:e.t("share")},{default:d((()=>[l(r,{title:e.t("share"),"is-link":"",onClick:o.onShare},null,8,["title","onClick"])])),_:1},8,["title"]),l(u,{title:e.t("custom")},{default:d((()=>[l(r,{title:e.t("custom"),"is-link":"",onClick:o.onCustom},null,8,["title","onClick"])])),_:1},8,["title"]),l(h,{id:a.FUNCTIONAL_ID_MAP.POPUP_CELL,ref:a.FUNCTIONAL_ID_MAP.POPUP_CELL,mode:"functional"},null,8,["id"]),l(h,{id:a.FUNCTIONAL_ID_MAP.POPUP_CELL_2,ref:a.FUNCTIONAL_ID_MAP.POPUP_CELL_2,mode:"functional"},null,8,["id"])])}]]);export{Ce as default};
