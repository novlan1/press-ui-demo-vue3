import{u as t,s as e}from"./utils.f8cec38d.js";import{t as s}from"./touch.bcbb2f5b.js";import{c as a}from"./version.066ec1d4.js";import{b as i}from"./rect.783e615e.js";import{a as n}from"./unit.f57193dc.js";import{_ as o,o as u,c as r,k as h,x as l,y as d,z as c,v as m,b as p}from"./index-26897e9f.js";const g=o({name:"PressSlider",mixins:[s],props:{range:Boolean,disabled:Boolean,useButtonSlot:Boolean,activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},max:{type:Number,default:100},min:{type:Number,default:0},step:{type:Number,default:1},value:{type:null,default:0},vertical:{type:Boolean,default:!1},barHeight:{type:[Number,String],default:""},customClass:{type:String,default:""},customStyle:{type:String,default:""}},emits:["drag-start","drag-end","drag","change"],data(){return{utils:t,style:e,barStyle:"",dataValue:this.value}},watch:{value:{handler(t){t!==this.dataValue&&this.updateValue(t)}}},created(){this.updateValue(this.value)},methods:{onTouchStart(t){if(this.disabled)return;const{index:e}=t.currentTarget.dataset;"number"!=typeof e&&"string"!=typeof e||(this.buttonIndex=+e),this.touchStart(t),this.startValue=this.format(this.dataValue),this.newValue=this.dataValue,this.isRange(this.newValue)?this.startValue=this.newValue.map((t=>this.format(t))):this.startValue=this.format(this.newValue),this.dragStatus="start"},onTouchMove(t){this.disabled||("start"===this.dragStatus&&this.$emit("drag-start"),this.touchMove(t),this.dragStatus="draging",i(this,".press-slider").then((t=>{const{vertical:e}=this,s=(e?this.deltaY:this.deltaX)/(e?t.height:t.width)*this.getRange();this.isRange(this.startValue)?this.newValue[this.buttonIndex]=this.startValue[this.buttonIndex]+s:this.newValue=this.startValue+s,this.updateValue(this.newValue,!1,!0)})))},onTouchEnd(){this.disabled||"draging"===this.dragStatus&&(this.updateValue(this.newValue,!0),this.$emit("drag-end"))},onClick(t){if(this.disabled)return;const{min:e}=this;i(this,".press-slider").then((s=>{const{vertical:a}=this,i=t.touches[0],n=a?i.clientY-s.top:i.clientX-s.left,o=a?s.height:s.width,u=Number(e)+n/o*this.getRange();if(this.isRange(this.dataValue)){const[t,e]=this.dataValue;u<=(t+e)/2?this.updateValue([u,e],!0):this.updateValue([t,u],!0)}else this.updateValue(u,!0)}))},isRange(t){const{range:e}=this;return e&&Array.isArray(t)},handleOverlap:t=>t[0]>t[1]?t.slice(0).reverse():t,updateValue(t,e,s){t=this.isRange(t)?this.handleOverlap(t).map((t=>this.format(t))):this.format(t),this.dataValue=t;const{vertical:i}=this,o=i?"height":"width";this.wrapperStyle=`\n          background: ${this.inactiveColor||""};\n          ${i?"width":"height"}: ${n(this.barHeight)||""};\n        `,this.barStyle=`\n          ${o}: ${this.calcMainAxis()};\n          left: ${i?0:this.calcOffset()};\n          top: ${i?this.calcOffset():0};\n          ${s?"transition: none;":""}\n        `,s&&this.$emit("drag",t),e&&this.$emit("change",t),(s||e)&&a()},getScope(){return Number(this.max)-Number(this.min)},getRange(){const{max:t,min:e}=this;return t-e},calcMainAxis(){const{dataValue:t}=this,{min:e}=this,s=this.getScope();return this.isRange(t)?100*(t[1]-t[0])/s+"%":100*(t-Number(e))/s+"%"},calcOffset(){const{dataValue:t}=this,{min:e}=this,s=this.getScope();return this.isRange(t)?100*(t[0]-Number(e))/s+"%":"0%"},format(t){const{max:e,min:s,step:a}=this;return Math.round(Math.max(s,Math.min(t,e))/a)*a}}},[["render",function(t,e,s,a,i,n){return u(),r("div",{class:"press-slider-index",style:d(s.customStyle)},[h("div",{class:l(s.customClass+" "+i.utils.bem2("slider",{disabled:s.disabled,vertical:s.vertical})),style:d(t.wrapperStyle),onClick:e[12]||(e[12]=(...t)=>n.onClick&&n.onClick(...t))},[h("div",{class:l([i.utils.bem2("slider__bar")]),style:d(i.barStyle+"; "+i.style({backgroundColor:s.activeColor}))},[s.range?(u(),r("div",{key:0,class:l([i.utils.bem2("slider__button-wrapper-left")]),"data-index":0,onTouchstart:e[0]||(e[0]=(...t)=>n.onTouchStart&&n.onTouchStart(...t)),onTouchmove:e[1]||(e[1]=c(((...t)=>n.onTouchMove&&n.onTouchMove(...t)),["stop","prevent"])),onTouchend:e[2]||(e[2]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t)),onTouchcancel:e[3]||(e[3]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t))},[s.useButtonSlot?m(t.$slots,"left-button",{key:0},void 0,!0):(u(),r("div",{key:1,class:l([i.utils.bem2("slider__button")])},null,2))],34)):p("v-if",!0),s.range?(u(),r("div",{key:1,class:l([i.utils.bem2("slider__button-wrapper-right")]),"data-index":1,onTouchstart:e[4]||(e[4]=(...t)=>n.onTouchStart&&n.onTouchStart(...t)),onTouchmove:e[5]||(e[5]=c(((...t)=>n.onTouchMove&&n.onTouchMove(...t)),["stop","prevent"])),onTouchend:e[6]||(e[6]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t)),onTouchcancel:e[7]||(e[7]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t))},[s.useButtonSlot?m(t.$slots,"right-button",{key:0},void 0,!0):(u(),r("div",{key:1,class:l([i.utils.bem2("slider__button")])},null,2))],34)):p("v-if",!0),s.range?p("v-if",!0):(u(),r("div",{key:2,class:l([i.utils.bem2("slider__button-wrapper")]),onTouchstart:e[8]||(e[8]=(...t)=>n.onTouchStart&&n.onTouchStart(...t)),onTouchmove:e[9]||(e[9]=c(((...t)=>n.onTouchMove&&n.onTouchMove(...t)),["stop","prevent"])),onTouchend:e[10]||(e[10]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t)),onTouchcancel:e[11]||(e[11]=(...t)=>n.onTouchEnd&&n.onTouchEnd(...t))},[s.useButtonSlot?m(t.$slots,"button",{key:0},void 0,!0):(u(),r("div",{key:1,class:l([i.utils.bem2("slider__button")])},null,2))],34))],6)],6)],4)}],["__scopeId","data-v-ee2e0cd4"]]);export{g as P};
