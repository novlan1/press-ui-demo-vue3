import{_ as t,o as s,c as o,n as e,p as i,h as a,m as n,e as r,k as l,t as c,l as m,F as u,w as d,d as h,j as p,ag as y}from"./index-38a6aa88.js";import{P as f}from"./press-icon-plus.6056b7b8.js";import{r as k}from"./system.3ebd09ca.js";import{b as C}from"./rect.515f795d.js";import{i as b,u as g}from"./utils.527a09c0.js";import{s as w}from"./style.0f94ff97.js";import{d as I,a as _}from"./press-component.d8ea5855.js";import{g as S}from"./event.5310d546.js";const v={rootStyle:function(t){return w({color:t.color,"background-color":t.backgroundColor,background:t.background})}};const $=t({name:"PressNoticeBar",options:{...I,styleIsolation:"shared"},components:{PressIconPlus:f},props:{text:{type:String,default:""},mode:{type:String,default:""},url:{type:String,default:""},openType:{type:String,default:"navigate"},delay:{type:Number,default:1},speed:{type:Number,default:60},scrollable:{type:Boolean,default:!1},leftIcon:{type:String,default:""},color:{type:String,default:""},backgroundColor:{type:String,default:""},background:{type:String,default:""},wrapable:Boolean,..._},emits:["close","click"],data:()=>({show:!0,duration:0,animationDuration:0,contentWidth:0,translateX:0,isNotInUni:b()}),computed:{noticeBarClass(){const{mode:t,wrapable:s,customClass:o}=this;return`${o} ${g.bem2("notice-bar",{withicon:t,wrapable:s})}`},noticeBarStyle(){const{color:t,backgroundColor:s,background:o}=this;return v.rootStyle({color:t,backgroundColor:s,background:o})},animationStyle(){const{animationDuration:t,delay:s,translateX:o}=this;return[`transform: translateX(${o}px);`,`transition: -webkit-transform ${t}ms linear ${s}ms, transform ${t}ms linear ${s}ms;`,"transform-origin: 50% 50% 0px;"].join(" ")},leftIconClass:()=>"press-notice-bar__left-icon",leftIconCustomClass:()=>"",rightIconClass:()=>"press-notice-bar__right-icon",rightIconCustomClass:()=>""},watch:{text:{handler(){this.init()}},speed:{handler(){this.init()}}},created(){},mounted(){this.init()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){this.timer&&clearTimeout(this.timer)},init(){k((()=>{Promise.all([C(this,".press-notice-bar__content"),C(this,".press-notice-bar__wrap")]).then((t=>{const[s,o]=t,{speed:e,scrollable:i}=this;if(null!=s&&null!=o&&s.width&&o.width&&!1!==i&&(i||o.width<s.width)){const t=(o.width+s.width)/e*1e3;this.wrapWidth=o.width,this.contentWidth=s.width,this.duration=t,this.scroll(!0)}}))}))},scroll(t=!1){this.timer&&clearTimeout(this.timer),this.timer=null,this.translateX=t?0:this.wrapWidth,this.animationDuration=0,k((()=>{this.translateX=-this.contentWidth,this.animationDuration=this.duration})),this.timer=setTimeout((()=>{this.scroll()}),this.duration)},onClickIcon(t){"closeable"===this.mode&&(this.timer&&clearTimeout(this.timer),this.timer=null,this.show=!1,this.$emit("close",S(t)))},onClick(t){this.$emit("click",t)}}},[["render",function(t,f,k,C,b,g){const w=p("PressIconPlus"),I=y;return s(),o("div",{class:"press-notice-bar-index"},[b.show?(s(),o("div",{key:0,class:e(g.noticeBarClass),style:i(g.noticeBarStyle),onClick:f[0]||(f[0]=(...t)=>g.onClick&&g.onClick(...t))},[k.leftIcon?(s(),a(w,{key:0,name:k.leftIcon,class:e([g.leftIconClass]),"custom-class":g.leftIconCustomClass},null,8,["name","class","custom-class"])):n(t.$slots,"left-icon",{key:1},void 0,!0),r("div",{class:"press-notice-bar__wrap"},[r("div",{class:e("press-notice-bar__content "+(!1!==k.scrollable||k.wrapable?"":"press-ellipsis")),style:i(g.animationStyle)},[l(c(k.text)+" ",1),k.text?m("v-if",!0):n(t.$slots,"default",{key:0},void 0,!0)],6)]),"closeable"===k.mode?(s(),a(w,{key:2,class:e([g.rightIconClass]),"custom-class":g.rightIconCustomClass,name:"cross",onClick:g.onClickIcon},null,8,["class","custom-class","onClick"])):"link"===k.mode?(s(),o(u,{key:3},[b.isNotInUni?(s(),a(w,{key:0,class:e([g.rightIconClass]),"custom-class":g.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])):(s(),a(I,{key:1,url:k.url,"open-type":k.openType},{default:d((()=>[h(w,{class:e([g.rightIconClass]),"custom-class":g.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])])),_:1},8,["url","open-type"]))],64)):n(t.$slots,"right-icon",{key:4},void 0,!0)],6)):m("v-if",!0)])}],["__scopeId","data-v-a4a5e600"]]);export{$ as P};
