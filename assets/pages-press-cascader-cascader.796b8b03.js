import{P as e}from"./press-icon-plus.a1094e70.js";import{a as t,P as s}from"./press-tab.b67835e5.js";import{s as a}from"./style.0f94ff97.js";import{u as l}from"./utils.d8f13396.js";import{_ as i,o,c as n,r as c,t as r,q as u,f as d,h,w as p,F as v,p as m,i as f,n as y,j as C,e as x}from"./index-66fd861e.js";import{P as b}from"./press-field.6ee9424f.js";import{P as g}from"./press-popup-plus.c2e56d09.js";import{b as k}from"./press-component.573dfcec.js";import{g as A}from"./computed.21f41328.js";import"./add-unit.9de8b2f7.js";import"./press-info.8563e54c.js";import"./press-sticky.5fc3d7e8.js";import"./rect.8d61e06e.js";import"./version.0d1ce575.js";import"./bind-event.62c2fb05.js";import"./event.b5c3f8af.js";import"./support-passive.bc409298.js";import"./touch.bcbb2f5b.js";import"./relation.8b10893c.js";import"./parent-map.b443f4cc.js";import"./press-cell.182b41b4.js";import"./link.af741451.js";import"./parent.59fa8a22.js";import"./press-overlay.1835b372.js";import"./press-transition.8a179cbe.js";function w(e,t,s){return e.selected&&e.selected[t]===s[t]}const O={isSelected:w,optionClass:function(e,t,s){return l.bem2("cascader__option",{selected:w(e,t,s),disabled:s.disabled})},optionStyle:function(e){const t=e.option.color||(w(e.tab,e.valueKey,e.option)?e.activeColor:void 0);return a({color:t})}};let F;var j;(j=F||(F={})).TEXT="text",j.VALUE="value",j.CHILDREN="children";const _={text:F.TEXT,value:F.VALUE,children:F.CHILDREN},N={name:"PressCascader",options:{styleIsolation:"shared"},components:{PressIcon:e,PressTab:t,PressTabs:s},props:{title:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:"请选择"},activeColor:{type:String,default:"#1989fa"},options:{type:Array,default:()=>[]},swipeable:{type:Boolean,default:!1},closeable:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},closeIcon:{type:String,default:"cross"},fieldNames:{type:Object,default:()=>_},useTitleSlot:Boolean},emits:["change","finish","close","click-tab"],data:()=>({tabs:[],activeTab:0,textKey:F.TEXT,valueKey:F.VALUE,childrenKey:F.CHILDREN,innerValue:"",utils:O}),watch:{options:{handler(){this.updateTabs()},deep:!0},value:{handler(e){this.updateValue(e)},deep:!0,immediate:!0},fieldNames:{handler(){this.updateFieldNames()},deep:!0,immediate:!0}},created(){this.updateTabs()},mounted(){},methods:{updateValue(e){if(void 0!==e){if(this.tabs.map((e=>e.selected&&e.selected[this.valueKey])).indexOf(e)>-1)return}this.innerValue=e,this.updateTabs()},updateFieldNames(){const{text:e="text",value:t="value",children:s="children"}=this.fieldNames||_;this.textKey=e,this.valueKey=t,this.childrenKey=s},getSelectedOptionsByValue(e,t){for(let s=0;s<e.length;s++){const a=e[s];if(a[this.valueKey]===t)return[a];if(a[this.childrenKey]){const e=this.getSelectedOptionsByValue(a[this.childrenKey],t);if(e)return[a,...e]}}},updateTabs(){const{options:e}=this,{innerValue:t}=this;if(e.length){if(void 0!==t){const s=this.getSelectedOptionsByValue(e,t);if(s){let t=e;const a=s.map((e=>{const s={options:t,selected:e},a=t.find((t=>t[this.valueKey]===e[this.valueKey]));return a&&(t=a[this.childrenKey]),s}));return t&&a.push({options:t,selected:null}),this.tabs=a,void wx.nextTick((()=>{this.activeTab=a.length-1}))}}this.tabs=[{options:e,selected:null}],this.activeTab=0}},onClose(){this.$emit("close")},onClickTab(e){const{index:t,title:s}=e;this.$emit("click-tab",{title:s,tabIndex:t}),this.activeTab=t},onSelect(e,t){if(t&&t.disabled)return;const{valueKey:s,childrenKey:a}=this;let{tabs:l}=this;if(l[e].selected=t,l.length>e+1&&(l=l.slice(0,e+1)),t[a]){const s={options:t[a],selected:null};l[e+1]?l[e+1]=s:l.push(s),wx.nextTick((()=>{this.activeTab=e+1}))}this.tabs=l;const i=l.map((e=>e.selected)).filter(Boolean),o=t[s],n={value:o,tabIndex:e,selectedOptions:i};this.innerValue=o,this.$emit("change",n),t[a]||this.$emit("finish",n)},getOptionsClass(e,t){return`${e.className||""} ${O.optionClass(t,this.valueKey,e)}`},getOptionsStyle(e,t){const{valueKey:s,activeColor:a}=this;return`${O.optionStyle({tab:t,valueKey:s,option:e,activeColor:a})}`},getUniqueKey:(e,t)=>`${e}-${t}`}};const K=(e,t,s)=>({text:e,value:t,children:s});function L(){return new Promise(((e,t)=>{A().then((t=>{const s=function(e){const{city_list:t,county_list:s,province_list:a}=e,l=new Map;Object.keys(a).forEach((e=>{l.set(e.slice(0,2),K(a[e],e,[]))}));const i=new Map;return Object.keys(t).forEach((e=>{const s=K(t[e],e,[]);i.set(e.slice(0,4),s);const a=l.get(e.slice(0,2));a&&a.children.push(s)})),Object.keys(s).forEach((e=>{const t=i.get(e.slice(0,4));t&&t.children.push(K(s[e],e))})),Array.from(l.values())}(t);e(s)})).catch((e=>{t(e)}))}))}const V=[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100"}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100"}]}];const S=i({i18n:{"zh-CN":{area:"地区",options:[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100",children:[{text:"上城区",value:"330102"},{text:"下城区",value:"330103"},{text:"江干区",value:"330104"}]},{text:"宁波市",value:"330200",children:[{text:"海曙区",value:"330203"},{text:"江北区",value:"330205"},{text:"北仑区",value:"330206"}]},{text:"温州市",value:"330300",children:[{text:"鹿城区",value:"330302"},{text:"龙湾区",value:"330303"},{text:"瓯海区",value:"330304"}]}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100",children:[{text:"玄武区",value:"320102"},{text:"秦淮区",value:"320104"},{text:"建邺区",value:"320105"}]},{text:"无锡市",value:"320200",children:[{text:"锡山区",value:"320205"},{text:"惠山区",value:"320206"},{text:"滨湖区",value:"320211"}]},{text:"徐州市",value:"320300",children:[{text:"鼓楼区",value:"320302"},{text:"云龙区",value:"320303"},{text:"贾汪区",value:"320305"}]}]}],selectArea:"请选择地区",customColor:"自定义颜色",asyncOptions:"异步加载选项",asyncOptions1:[{text:"浙江省",value:"330000",children:[]}],asyncOptions2:[{text:"杭州市",value:"330100"},{text:"宁波市",value:"330200"}],currentLevel:e=>`当前为第 ${e} 级`,chinaAreaData:"中国省市区数据",customContent:"自定义选项上方内容",customFieldNames:"自定义字段名"},"en-US":{area:"Area",options:[{text:"Zhejiang",value:"330000",children:[{text:"Hangzhou",value:"330100",children:[{text:"Shangcheng",value:"330102"},{text:"Xiacheng",value:"330103"},{text:"Jianggan",value:"330104"}]},{text:"Ningbo",value:"330200",children:[{text:"Haishu",value:"330203"},{text:"Jiangbei",value:"330205"},{text:"Beilun",value:"330206"}]},{text:"Wenzhou",value:"330300",children:[{text:"Lucheng",value:"330302"},{text:"Longwan",value:"330303"},{text:"Ouhai",value:"330304"}]}]},{text:"Jiangsu",value:"320000",children:[{text:"Nanjing",value:"320100",children:[{text:"Xuanwu",value:"320102"},{text:"Qinghuai",value:"320104"},{text:"Jianye",value:"320105"}]},{text:"Wuxi",value:"320200",children:[{text:"Xishan",value:"320205"},{text:"Huishan",value:"320206"},{text:"Binhu",value:"320211"}]},{text:"Xuzhou",value:"320300",children:[{text:"Gulou",value:"320302"},{text:"Yunlong",value:"320303"},{text:"Jiawang",value:"320305"}]}]}],selectArea:"Select Area",customColor:"Custom Color",asyncOptions:"Async Options",asyncOptions1:[{text:"Zhejiang",value:"330000",children:[]}],asyncOptions2:[{text:"Hangzhou",value:"330100"},{text:"Ningbo",value:"330200"}],currentLevel:e=>`Current level is ${e}`,chinaAreaData:"China Area Data",customContent:"Custom Content",customFieldNames:"Custom Field Names"}},components:{PressCascader:i(N,[["render",function(e,t,s,a,l,i){const b=x("press-icon"),g=x("press-tab"),k=x("press-tabs");return o(),n("div",{class:"press-cascader-index"},[s.showHeader?(o(),n("div",{key:0,class:"press-cascader__header"},[s.useTitleSlot?c(e.$slots,"title",{key:0},void 0,!0):(o(),n("span",{key:1,class:"press-cascader__title"},r(s.title),1)),s.closeable?(o(),u(b,{key:2,name:s.closeIcon,class:"press-cascader__close-icon",onClick:i.onClose},null,8,["name","onClick"])):d("v-if",!0)])):d("v-if",!0),h(k,{ref:"tabs",active:l.activeTab,"custom-class":"press-cascader__tabs","wrap-class":"press-cascader__tabs-wrap","tab-class":"press-cascader__tab",color:s.activeColor,border:!1,swipeable:s.swipeable,onClick:i.onClickTab},{default:p((()=>[(o(!0),n(v,null,m(l.tabs,((e,t)=>(o(),u(g,{key:e.tabIndex,title:e.selected?e.selected[l.textKey]:s.placeholder,style:{width:"100%"},"title-style":e.selected?"":"color: #969799;font-weight:normal;"},{default:p((()=>[f("div",{class:"press-cascader__options"},[(o(!0),n(v,null,m(e.options,((s,a)=>(o(),n("div",{key:""+i.getUniqueKey(a,"option"),class:y([`${i.getOptionsClass(s,e)}`]),style:C(""+i.getOptionsStyle(s,e)),onClick:()=>i.onSelect(t,s)},[f("span",null,r(s[l.textKey]),1),l.utils.isSelected(e,l.valueKey,s)?(o(),u(b,{key:0,name:"success",size:"18"})):d("v-if",!0)],14,["onClick"])))),128))])])),_:2},1032,["title","title-style"])))),128))])),_:1},8,["active","color","swipeable","onClick"])])}],["__scopeId","data-v-3fc143c1"]]),PressField:b,PressPopupPlus:g},data(){return{show:{basic:!1,customColor:!1,asyncOptions:!1,customFieldNames:!1,chinaArea:!1},leaving:{basic:!1,customColor:!1,asyncOptions:!1,customFieldNames:!1,chinaArea:!1},options:V,fieldValue:{basic:"",customColor:"",asyncOptions:"",customFieldNames:"",chinaArea:""},cascaderValue:{basic:"",customColor:"",asyncOptions:"",customFieldNames:"",chinaArea:""},curDemo:"",asyncStateOptions:this.t("asyncOptions1"),fieldNames:{text:"name",value:"code",children:"items"},chinaArea:[]}},computed:{isMp:()=>!1,customFieldOptions(){return function(e){const t=k(e),s=e=>{"text"in e&&(e.name=e.text,delete e.text),"value"in e&&(e.code=e.value,delete e.value),"children"in e&&(e.items=e.children,delete e.children,e.items.forEach(s))};return t.forEach(s),t}(this.t("options"))}},mounted(){this.getChinaArea()},methods:{onClick(e){this.hideKeyboard(),this.curDemo=e,this.show[e]=!0,this.leaving[this.curDemo]=!0},onClose(){this.show[this.curDemo]=!1},onFinish(e){console.log("[onFinish] detail: ",e);const{selectedOptions:t,value:s}=e,a=t.map((e=>e.text||e.name)).join("/");this.fieldValue[this.curDemo]=a,this.cascaderValue[this.curDemo]=s,this.onClose()},hideKeyboard(){uni.hideKeyboard()},loadDynamicOptions(e){const{value:t}=e;"330000"===t&&setTimeout((()=>{this.$set(this.asyncStateOptions[0],"children",this.t("asyncOptions2"))}),500)},afterLeave(){this.leaving[this.curDemo]=!1},getChinaArea(){L().then((e=>{this.chinaArea=e}))}}},[["render",function(e,t,s,a,l,i){const c=x("press-field"),r=x("press-cascader"),v=x("press-popup-plus"),m=x("demo-block");return o(),n("div",{class:"demo-wrap"},[h(m,{title:e.t("basicUsage")},{default:p((()=>[h(c,{value:l.fieldValue.basic,"model-value":l.fieldValue.basic,"is-link":"",readonly:i.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[0]||(t[0]=e=>i.onClick("basic")),onClickInput:t[1]||(t[1]=e=>i.onClick("basic"))},null,8,["value","model-value","readonly","label","placeholder"]),h(v,{show:l.show.basic,round:"",position:"bottom",onAfterLeave:i.afterLeave},{default:p((()=>[l.show.basic||l.leaving.basic?(o(),u(r,{key:0,value:l.cascaderValue.basic,title:e.t("selectArea"),options:e.t("options"),onClose:i.onClose,onFinish:i.onFinish},null,8,["value","title","options","onClose","onFinish"])):d("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),h(m,{title:e.t("chinaAreaData")},{default:p((()=>[h(c,{value:l.fieldValue.chinaArea,"is-link":"",readonly:i.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[2]||(t[2]=e=>i.onClick("chinaArea")),onClickInput:t[3]||(t[3]=e=>i.onClick("chinaArea"))},null,8,["value","readonly","label","placeholder"]),h(v,{show:l.show.chinaArea,round:"",position:"bottom",onAfterLeave:i.afterLeave},{default:p((()=>[l.show.chinaArea||l.leaving.chinaArea?(o(),u(r,{key:0,value:l.cascaderValue.chinaArea,title:e.t("selectArea"),options:l.chinaArea,onClose:i.onClose,onFinish:i.onFinish},null,8,["value","title","options","onClose","onFinish"])):d("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),h(m,{title:e.t("customColor")},{default:p((()=>[h(c,{value:l.fieldValue.customColor,"is-link":"",readonly:i.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[4]||(t[4]=e=>i.onClick("customColor")),onClickInput:t[5]||(t[5]=e=>i.onClick("customColor"))},null,8,["value","readonly","label","placeholder"]),h(v,{show:l.show.customColor,round:"",position:"bottom",onAfterLeave:i.afterLeave},{default:p((()=>[l.show.customColor||l.leaving.customColor?(o(),u(r,{key:0,value:l.cascaderValue.customColor,title:e.t("selectArea"),options:e.t("options"),"active-color":"#ee0a24",onClose:i.onClose,onFinish:i.onFinish},null,8,["value","title","options","onClose","onFinish"])):d("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),h(m,{title:e.t("asyncOptions")},{default:p((()=>[h(c,{value:l.fieldValue.asyncOptions,"is-link":"",readonly:i.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[6]||(t[6]=e=>i.onClick("asyncOptions")),onClickInput:t[7]||(t[7]=e=>i.onClick("asyncOptions"))},null,8,["value","readonly","label","placeholder"]),h(v,{show:l.show.asyncOptions,round:"",position:"bottom",onAfterLeave:i.afterLeave},{default:p((()=>[l.show.asyncOptions||l.leaving.asyncOptions?(o(),u(r,{key:0,value:l.cascaderValue.asyncOptions,title:e.t("selectArea"),options:l.asyncStateOptions,onClose:i.onClose,onFinish:i.onFinish,onChange:i.loadDynamicOptions},null,8,["value","title","options","onClose","onFinish","onChange"])):d("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),h(m,{title:e.t("customFieldNames")},{default:p((()=>[h(c,{value:l.fieldValue.customFieldNames,"is-link":"",readonly:i.isMp,label:e.t("area"),placeholder:e.t("customFieldNames"),onClick:t[8]||(t[8]=e=>i.onClick("customFieldNames")),onClickInput:t[9]||(t[9]=e=>i.onClick("customFieldNames"))},null,8,["value","readonly","label","placeholder"]),h(v,{show:l.show.customFieldNames,round:"",position:"bottom",onAfterLeave:i.afterLeave},{default:p((()=>[l.show.customFieldNames||l.leaving.customFieldNames?(o(),u(r,{key:0,value:l.cascaderValue.customFieldNames,title:e.t("selectArea"),"field-names":l.fieldNames,options:i.customFieldOptions,onClose:i.onClose,onFinish:i.onFinish,onChange:i.loadDynamicOptions},null,8,["value","title","field-names","options","onClose","onFinish","onChange"])):d("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"])])}]]);export{S as default};
