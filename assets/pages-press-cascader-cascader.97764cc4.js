import{z as e,u as t,_ as a,q as l,A as s,o,c as i,r as n,t as c,f as u,d as r,i as d,j as h,F as p,k as v,a as m,n as f,b as y,e as C}from"./index-dc5fce78.js";import{a as b,P as x}from"./press-tab.54844117.js";import{P as g}from"./press-field.74166292.js";import{P as k}from"./press-popup-plus.8f4bd2d2.js";import{h as A,d as O}from"./hide-keyboard.3b241f06.js";import{g as w}from"./computed.8d5fdffa.js";import"./press-sticky.7f6d74ef.js";import"./bind-event.e36b34b6.js";import"./touch.bcbb2f5b.js";import"./relation.8b10893c.js";import"./parent-map.7daf54ee.js";import"./scroll-view.86ab113c.js";import"./parent.59fa8a22.js";function F(e,t,a){return e.selected&&e.selected[t]===a[t]}const _={isSelected:F,optionClass:function(t,a,l){return e.bem2("cascader__option",{selected:F(t,a,l),disabled:l.disabled})},optionStyle:function(e){const a=e.option.color||(F(e.tab,e.valueKey,e.option)?e.activeColor:void 0);return t({color:a})}};let N;var V;(V=N||(N={})).TEXT="text",V.VALUE="value",V.CHILDREN="children";const L={text:N.TEXT,value:N.VALUE,children:N.CHILDREN},K={name:"PressCascader",options:{styleIsolation:"shared"},components:{PressIcon:l,PressTab:b,PressTabs:x},props:{title:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:"请选择"},activeColor:{type:String,default:"#1989fa"},options:{type:Array,default:()=>[]},swipeable:{type:Boolean,default:!1},closeable:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},closeIcon:{type:String,default:"cross"},fieldNames:{type:Object,default:()=>L},useTitleSlot:Boolean},emits:["change","finish","close","click-tab"],data:()=>({tabs:[],activeTab:0,textKey:N.TEXT,valueKey:N.VALUE,childrenKey:N.CHILDREN,innerValue:"",utils:_}),watch:{options:{handler(){this.updateTabs()},deep:!0},value:{handler(e){this.updateValue(e)},deep:!0,immediate:!0},fieldNames:{handler(){this.updateFieldNames()},deep:!0,immediate:!0}},created(){this.updateTabs()},mounted(){},methods:{updateValue(e){if(void 0!==e){if(this.tabs.map((e=>e.selected&&e.selected[this.valueKey])).indexOf(e)>-1)return}this.innerValue=e,this.updateTabs()},updateFieldNames(){const{text:e="text",value:t="value",children:a="children"}=this.fieldNames||L;this.textKey=e,this.valueKey=t,this.childrenKey=a},getSelectedOptionsByValue(e,t){for(let a=0;a<e.length;a++){const l=e[a];if(l[this.valueKey]===t)return[l];if(l[this.childrenKey]){const e=this.getSelectedOptionsByValue(l[this.childrenKey],t);if(e)return[l,...e]}}},updateTabs(){const{options:e}=this,{innerValue:t}=this;if(e.length){if(void 0!==t){const a=this.getSelectedOptionsByValue(e,t);if(a){let t=e;const l=a.map((e=>{const a={options:t,selected:e},l=t.find((t=>t[this.valueKey]===e[this.valueKey]));return l&&(t=l[this.childrenKey]),a}));return t&&l.push({options:t,selected:null}),this.tabs=l,void s((()=>{this.activeTab=l.length-1}))}}this.tabs=[{options:e,selected:null}],this.activeTab=0}},onClose(){this.$emit("close")},onClickTab(e){const{index:t,title:a}=e;this.$emit("click-tab",{title:a,tabIndex:t}),this.activeTab=t},onSelect(e,t){if(t&&t.disabled)return;const{valueKey:a,childrenKey:l}=this;let{tabs:o}=this;if(o[e].selected=t,o.length>e+1&&(o=o.slice(0,e+1)),t[l]){const a={options:t[l],selected:null};o[e+1]?o[e+1]=a:o.push(a),s((()=>{this.activeTab=e+1}))}this.tabs=o;const i=o.map((e=>e.selected)).filter(Boolean),n=t[a],c={value:n,tabIndex:e,selectedOptions:i};this.innerValue=n,this.$emit("change",c),t[l]||this.$emit("finish",c)},getOptionsClass(e,t){return`${e.className||""} ${_.optionClass(t,this.valueKey,e)}`},getOptionsStyle(e,t){const{valueKey:a,activeColor:l}=this;return`${_.optionStyle({tab:t,valueKey:a,option:e,activeColor:l})}`},getUniqueKey:(e,t)=>`${e}-${t}`}};const T=(e,t,a)=>({text:e,value:t,children:a});function S(){return new Promise(((e,t)=>{w().then((t=>{const a=function(e){const{city_list:t,county_list:a,province_list:l}=e,s=new Map;Object.keys(l).forEach((e=>{s.set(e.slice(0,2),T(l[e],e,[]))}));const o=new Map;return Object.keys(t).forEach((e=>{const a=T(t[e],e,[]);o.set(e.slice(0,4),a);const l=s.get(e.slice(0,2));l&&l.children.push(a)})),Object.keys(a).forEach((e=>{const t=o.get(e.slice(0,4));t&&t.children.push(T(a[e],e))})),Array.from(s.values())}(t);e(a)})).catch((e=>{t(e)}))}))}const j=[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100"}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100"}]}];const P=a({i18n:{"zh-CN":{area:"地区",options:[{text:"浙江省",value:"330000",children:[{text:"杭州市",value:"330100",children:[{text:"上城区",value:"330102"},{text:"下城区",value:"330103"},{text:"江干区",value:"330104"}]},{text:"宁波市",value:"330200",children:[{text:"海曙区",value:"330203"},{text:"江北区",value:"330205"},{text:"北仑区",value:"330206"}]},{text:"温州市",value:"330300",children:[{text:"鹿城区",value:"330302"},{text:"龙湾区",value:"330303"},{text:"瓯海区",value:"330304"}]}]},{text:"江苏省",value:"320000",children:[{text:"南京市",value:"320100",children:[{text:"玄武区",value:"320102"},{text:"秦淮区",value:"320104"},{text:"建邺区",value:"320105"}]},{text:"无锡市",value:"320200",children:[{text:"锡山区",value:"320205"},{text:"惠山区",value:"320206"},{text:"滨湖区",value:"320211"}]},{text:"徐州市",value:"320300",children:[{text:"鼓楼区",value:"320302"},{text:"云龙区",value:"320303"},{text:"贾汪区",value:"320305"}]}]}],selectArea:"请选择地区",customColor:"自定义颜色",asyncOptions:"异步加载选项",asyncOptions1:[{text:"浙江省",value:"330000",children:[]}],asyncOptions2:[{text:"杭州市",value:"330100"},{text:"宁波市",value:"330200"}],currentLevel:e=>`当前为第 ${e} 级`,chinaAreaData:"中国省市区数据",customContent:"自定义选项上方内容",customFieldNames:"自定义字段名"},"en-US":{area:"Area",options:[{text:"Zhejiang",value:"330000",children:[{text:"Hangzhou",value:"330100",children:[{text:"Shangcheng",value:"330102"},{text:"Xiacheng",value:"330103"},{text:"Jianggan",value:"330104"}]},{text:"Ningbo",value:"330200",children:[{text:"Haishu",value:"330203"},{text:"Jiangbei",value:"330205"},{text:"Beilun",value:"330206"}]},{text:"Wenzhou",value:"330300",children:[{text:"Lucheng",value:"330302"},{text:"Longwan",value:"330303"},{text:"Ouhai",value:"330304"}]}]},{text:"Jiangsu",value:"320000",children:[{text:"Nanjing",value:"320100",children:[{text:"Xuanwu",value:"320102"},{text:"Qinghuai",value:"320104"},{text:"Jianye",value:"320105"}]},{text:"Wuxi",value:"320200",children:[{text:"Xishan",value:"320205"},{text:"Huishan",value:"320206"},{text:"Binhu",value:"320211"}]},{text:"Xuzhou",value:"320300",children:[{text:"Gulou",value:"320302"},{text:"Yunlong",value:"320303"},{text:"Jiawang",value:"320305"}]}]}],selectArea:"Select Area",customColor:"Custom Color",asyncOptions:"Async Options",asyncOptions1:[{text:"Zhejiang",value:"330000",children:[]}],asyncOptions2:[{text:"Hangzhou",value:"330100"},{text:"Ningbo",value:"330200"}],currentLevel:e=>`Current level is ${e}`,chinaAreaData:"China Area Data",customContent:"Custom Content",customFieldNames:"Custom Field Names"}},components:{PressCascader:a(K,[["render",function(e,t,a,l,s,b){const x=C("PressIcon"),g=C("PressTab"),k=C("PressTabs");return o(),i("div",{class:"press-cascader-index"},[a.showHeader?(o(),i("div",{key:0,class:"press-cascader__header"},[a.useTitleSlot?n(e.$slots,"title",{key:0},void 0,!0):(o(),i("span",{key:1,class:"press-cascader__title"},c(a.title),1)),a.closeable?(o(),u(x,{key:2,name:a.closeIcon,class:"press-cascader__close-icon",onClick:b.onClose},null,8,["name","onClick"])):r("v-if",!0)])):r("v-if",!0),d(k,{ref:"tabs",active:s.activeTab,"custom-class":"press-cascader__tabs","wrap-class":"press-cascader__tabs-wrap","tab-class":"press-cascader__tab",color:a.activeColor,border:!1,swipeable:a.swipeable,onClick:b.onClickTab},{default:h((()=>[(o(!0),i(p,null,v(s.tabs,((e,t)=>(o(),u(g,{key:e.tabIndex,title:e.selected?e.selected[s.textKey]:a.placeholder,style:{width:"100%"},"title-style":e.selected?"":"color: #969799;font-weight:normal;"},{default:h((()=>[m("div",{class:"press-cascader__options"},[(o(!0),i(p,null,v(e.options,((a,l)=>(o(),i("div",{key:""+b.getUniqueKey(l,"option"),class:f([`${b.getOptionsClass(a,e)}`]),style:y(""+b.getOptionsStyle(a,e)),onClick:()=>b.onSelect(t,a)},[m("span",null,c(a[s.textKey]),1),s.utils.isSelected(e,s.valueKey,a)?(o(),u(x,{key:0,name:"success",size:"18"})):r("v-if",!0)],14,["onClick"])))),128))])])),_:2},1032,["title","title-style"])))),128))])),_:1},8,["active","color","swipeable","onClick"])])}],["__scopeId","data-v-7cb2b501"]]),PressField:g,PressPopupPlus:k},data(){return{show:{basic:!1,customColor:!1,asyncOptions:!1,customFieldNames:!1,chinaArea:!1},leaving:{basic:!1,customColor:!1,asyncOptions:!1,customFieldNames:!1,chinaArea:!1},options:j,fieldValue:{basic:"",customColor:"",asyncOptions:"",customFieldNames:"",chinaArea:""},cascaderValue:{basic:"",customColor:"",asyncOptions:"",customFieldNames:"",chinaArea:""},curDemo:"",asyncStateOptions:this.t("asyncOptions1"),fieldNames:{text:"name",value:"code",children:"items"},chinaArea:[]}},computed:{isMp:()=>!1,customFieldOptions(){return function(e){const t=O(e),a=e=>{"text"in e&&(e.name=e.text,delete e.text),"value"in e&&(e.code=e.value,delete e.value),"children"in e&&(e.items=e.children,delete e.children,e.items.forEach(a))};return t.forEach(a),t}(this.t("options"))}},mounted(){this.getChinaArea()},methods:{onClick(e){A(),this.curDemo=e,this.show[e]=!0,this.leaving[this.curDemo]=!0},onClose(){this.show[this.curDemo]=!1},onFinish(e){console.log("[onFinish] detail: ",e);const{selectedOptions:t,value:a}=e,l=t.map((e=>e.text||e.name)).join("/");this.fieldValue[this.curDemo]=l,this.cascaderValue[this.curDemo]=a,this.onClose()},loadDynamicOptions(e){const{value:t}=e;"330000"===t&&setTimeout((()=>{this.asyncStateOptions[0].children=this.t("asyncOptions2")}),500)},afterLeave(){this.leaving[this.curDemo]=!1},getChinaArea(){S().then((e=>{this.chinaArea=e}))}}},[["render",function(e,t,a,l,s,n){const c=C("PressField"),p=C("PressCascader"),v=C("PressPopupPlus"),m=C("demo-block");return o(),i("div",{class:"demo-wrap"},[d(m,{title:e.t("basicUsage")},{default:h((()=>[d(c,{value:s.fieldValue.basic,"model-value":s.fieldValue.basic,"is-link":"",readonly:n.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[0]||(t[0]=e=>n.onClick("basic")),onClickInput:t[1]||(t[1]=e=>n.onClick("basic"))},null,8,["value","model-value","readonly","label","placeholder"]),d(v,{show:s.show.basic,round:"",position:"bottom",onAfterLeave:n.afterLeave},{default:h((()=>[s.show.basic||s.leaving.basic?(o(),u(p,{key:0,value:s.cascaderValue.basic,title:e.t("selectArea"),options:e.t("options"),onClose:n.onClose,onFinish:n.onFinish},null,8,["value","title","options","onClose","onFinish"])):r("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),d(m,{title:e.t("chinaAreaData")},{default:h((()=>[d(c,{value:s.fieldValue.chinaArea,"model-value":s.fieldValue.chinaArea,"is-link":"",readonly:n.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[2]||(t[2]=e=>n.onClick("chinaArea")),onClickInput:t[3]||(t[3]=e=>n.onClick("chinaArea"))},null,8,["value","model-value","readonly","label","placeholder"]),d(v,{show:s.show.chinaArea,round:"",position:"bottom",onAfterLeave:n.afterLeave},{default:h((()=>[s.show.chinaArea||s.leaving.chinaArea?(o(),u(p,{key:0,value:s.cascaderValue.chinaArea,title:e.t("selectArea"),options:s.chinaArea,onClose:n.onClose,onFinish:n.onFinish},null,8,["value","title","options","onClose","onFinish"])):r("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),d(m,{title:e.t("customColor")},{default:h((()=>[d(c,{value:s.fieldValue.customColor,"model-value":s.fieldValue.customColor,"is-link":"",readonly:n.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[4]||(t[4]=e=>n.onClick("customColor")),onClickInput:t[5]||(t[5]=e=>n.onClick("customColor"))},null,8,["value","model-value","readonly","label","placeholder"]),d(v,{show:s.show.customColor,round:"",position:"bottom",onAfterLeave:n.afterLeave},{default:h((()=>[s.show.customColor||s.leaving.customColor?(o(),u(p,{key:0,value:s.cascaderValue.customColor,title:e.t("selectArea"),options:e.t("options"),"active-color":"#ee0a24",onClose:n.onClose,onFinish:n.onFinish},null,8,["value","title","options","onClose","onFinish"])):r("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),d(m,{title:e.t("asyncOptions")},{default:h((()=>[d(c,{value:s.fieldValue.asyncOptions,"model-value":s.fieldValue.asyncOptions,"is-link":"",readonly:n.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[6]||(t[6]=e=>n.onClick("asyncOptions")),onClickInput:t[7]||(t[7]=e=>n.onClick("asyncOptions"))},null,8,["value","model-value","readonly","label","placeholder"]),d(v,{show:s.show.asyncOptions,round:"",position:"bottom",onAfterLeave:n.afterLeave},{default:h((()=>[s.show.asyncOptions||s.leaving.asyncOptions?(o(),u(p,{key:0,value:s.cascaderValue.asyncOptions,title:e.t("selectArea"),options:s.asyncStateOptions,onClose:n.onClose,onFinish:n.onFinish,onChange:n.loadDynamicOptions},null,8,["value","title","options","onClose","onFinish","onChange"])):r("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"]),d(m,{title:e.t("customFieldNames")},{default:h((()=>[d(c,{value:s.fieldValue.customFieldNames,"model-value":s.fieldValue.customFieldNames,"is-link":"",readonly:n.isMp,label:e.t("area"),placeholder:e.t("selectArea"),onClick:t[8]||(t[8]=e=>n.onClick("customFieldNames")),onClickInput:t[9]||(t[9]=e=>n.onClick("customFieldNames"))},null,8,["value","model-value","readonly","label","placeholder"]),d(v,{show:s.show.customFieldNames,round:"",position:"bottom",onAfterLeave:n.afterLeave},{default:h((()=>[s.show.customFieldNames||s.leaving.customFieldNames?(o(),u(p,{key:0,value:s.cascaderValue.customFieldNames,title:e.t("selectArea"),"field-names":s.fieldNames,options:n.customFieldOptions,onClose:n.onClose,onFinish:n.onFinish,onChange:n.loadDynamicOptions},null,8,["value","title","field-names","options","onClose","onFinish","onChange"])):r("v-if",!0)])),_:1},8,["show","onAfterLeave"])])),_:1},8,["title"])])}]]);export{P as default};
