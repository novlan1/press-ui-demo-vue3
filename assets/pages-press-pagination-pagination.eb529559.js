import{P as t}from"./press-cell.a0845ac7.js";import{_ as e,o,c as s,f as n,w as i,F as r,v as l,n as a,h as c,t as p,e as h,S as u,j as m,af as d,ag as g,ah as f}from"./index-43eb3ea0.js";import{P as C}from"./press-popover.186cb4b4.js";import{b as P,h as T}from"./rect.23461412.js";import{i as v}from"./utils.bb2d8d10.js";import{P as x}from"./press-popup-cell.2a15ca38.js";import{P as y}from"./press-picker.10b59dc4.js";import"./press-icon-plus.43efdcdd.js";import"./style.0f94ff97.js";import"./add-unit.0c57c089.js";import"./validator.84caa8d5.js";import"./press-info.68d3dd51.js";import"./press-component.181873fd.js";import"./link.82331220.js";import"./event.1c00601d.js";import"./support-passive.bc409298.js";import"./version.7ee5c281.js";import"./press-popup.7d863f9b.js";import"./press-button.1db29ede.js";import"./press-loading-plus.e7ffc3ab.js";import"./press-loading.bae3cb19.js";import"./button.49122d4f.js";import"./function.30ad8366.js";import"./press-switch.3a23dc52.js";import"./computed.df3a0dd3.js";import"./functional.a82aa739.js";import"./index.a21f0567.js";let j=null;const b=e({name:"PressPagination",components:{PressPopover:C},props:{total:{type:Number,default:0},current:{type:Number,default:0},expand:{type:Boolean,default:!1},tipTemplate:{type:String,default:"第{{0}}页"},autoScroll:{type:Number,default:1},safeAreaInsetBottom:{type:Boolean,default:!0},customClass:{type:String,default:""},mode:{type:String,default:""}},options:{virtualHost:!0,styleIsolation:"shared"},emits:["change"],data:()=>({innerCurrent:0,scrollToView:"",tipOffset:0,selectedEvent:!1,zonesBox:{},scrollTop:0,old:{scrollTop:0}}),computed:{pageList(){return Array.from({length:this.total}).map(((t,e)=>e+1))},tipStyle(){return`top: ${this.tipOffset}px;bottom: unset;right: 50px;width: max-content;left: auto;transform: translateY(-50%);line-height: 16px;min-width: 42px;`},pageTip(){return this.tipTemplate.replace("{{0}}",this.innerCurrent)}},watch:{current:{handler(t){const e=this.pageList.findIndex((e=>e===t));this.innerCurrent=e>-1?this.pageList[e]:this.pageList[0],this.$nextTick((()=>{this.scrollTo()}))},immediate:!0},total:{handler(){this.$nextTick((()=>{this.getScrollBarSize()}))}},mode:{handler(){this.$nextTick((()=>{this.getScrollBarSize()}))}}},mounted(){this.selectedEvent=!1,this.getScrollBarSize()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},updated(){this.$nextTick().then((()=>{this.updatePopoverTipPosition()}))},methods:{onDestroyed(){this.selectedEvent=!1,j&&(clearTimeout(j),j=null)},getScrollBarSize(){P(this,".press-scrollbar").then((t=>{t&&(this.zonesBox={top:t.top,bottom:t.bottom,height:t.height})}))},updatePopoverTipPosition(){P(this,`#seq-${this.innerCurrent}`).then((t=>{t&&(this.tipOffset=t.top-this.zonesBox.top+t.height/2)}))},scroll(t){v()?this.old.scrollTop=t.target.scrollTop:this.old.scrollTop=t.detail.scrollTop,this.updatePopoverTipPosition()},scrollTo(){const{autoScroll:t}=this;this.scrollToView=`seq-${this.innerCurrent}`,this.scrollTop=this.old.scrollTop,Promise.all([T(this,"#zoneBox"),P(this,`#seq-${this.innerCurrent}`)]).then((([e,o])=>{if(!o)return;const{top:s,bottom:n,height:i=0}=this.zonesBox;if(i>0){if(o.top-s<t*o.height)this.scrollTop=Math.max(1,(this.innerCurrent-1-t)*o.height);else if(n-o.bottom<t*o.height){const s=(this.innerCurrent+t)*o.height-i;this.scrollTop=Math.min(s,e.scrollHeight-i)}this.updatePopoverTipPosition()}}))},handleSelect(t){j&&(clearTimeout(j),j=null),this.selectedEvent=!0,this.innerCurrent!==t&&(this.innerCurrent=t,this.$emit("change",t)),this.scrollTo(),j=setTimeout((()=>{this.selectedEvent=!1}),500)}}},[["render",function(t,e,d,g,f,C){const P=u,T=m("PressPopover");return o(),s("div",{class:a(["press-pagination",[d.customClass,{"press-pagination--safe":d.safeAreaInsetBottom},{"press-pagination--hor":"hor"===d.mode}]])},[C.pageList.length>1?(o(),s("div",{key:0,class:"press-pagination__wrap"},[n(P,{id:"zoneBox",class:a(["press-scrollbar","press-scrollbar--active"]),"scroll-y":"true","scroll-with-animation":"","enable-flex":!0,"scroll-top":f.scrollTop,onScroll:C.scroll},{default:i((()=>[(o(!0),s(r,null,l(C.pageList,((t,e)=>(o(),s("div",{id:"seq-"+t,key:e,class:a(["press-scrollbar__scale",[{"press-scrollbar__scale--selected":f.innerCurrent===t},`press-scrollbar__scale--total-${d.total}`]]),onClick:o=>C.handleSelect(t,e)},[c("span",null,p(t),1)],10,["id","onClick"])))),128))])),_:1},8,["scroll-top","onScroll"]),n(T,{show:f.selectedEvent,placement:"left","custom-style":C.tipStyle},{default:i((()=>[c("p",null,p(C.pageTip),1)])),_:1},8,["show","custom-style"])])):h("v-if",!0)],2)}],["__scopeId","data-v-aa89d3ea"]]),S={pageTotal:30,current:2,expand:!1},_=Array.from({length:4}).map(((t,e)=>10**e)).reduce(((t,e)=>{for(let o=1;o<10;o++)t.push(e*o);return t}),[]).map((t=>({label:t,value:t})));const k=e({components:{PressPagination:b,PressPopupCell:x,PressPicker:y,PressCell:t},data(){const t={...S};return{sectionStyle:"margin: 0;background: #f7f8fa;",headerStyle:"background: #f7f8fa;",FUNCTIONAL_ID_MAP:f,mode:"",componentConfig:t}},methods:{onShowBasicPopupCell(){const{pageTotal:t,current:e}=this.componentConfig;!function({context:t,callback:e,pageTotal:o,current:s,isHor:n}){d({context:t,title:"自定义设置",closeIcon:!0,cellList:[{label:"页面数",value:o,click:({context:s})=>{s.closeDialog(),g({title:"页面数",closeIcon:!0,list:_,current:{value:o},context:t}).then((({item:o})=>{S.pageTotal=o.value,t.onGTip("设置成功"),"function"==typeof e.changePageTotal&&e.changePageTotal.call(t,o.value)})).catch((()=>{}))}},{label:"当前页",value:s,click:({context:n})=>{n.closeDialog(),g({title:"当前页",closeIcon:!0,list:_.filter((t=>t.value<=o)),current:{value:s},context:t}).then((({item:o})=>{S.current=o.value,t.onGTip("设置成功"),"function"==typeof e.changeCurrent&&e.changeCurrent.call(t,o.value)})).catch((()=>{}))}},{label:"是否为Hor模式",type:"switch",open:n,click:({context:o})=>{o.closeDialog(),t.onGTip("设置成功"),"function"==typeof e.changeHor&&e.changeHor.call(t,!n)}}]})}({context:this,callback:{changePageTotal:this.changePageTotal,changeCurrent:this.changeCurrent,changeHor:this.changeHor},pageTotal:t,current:e,isHor:"hor"===this.mode})},changeExpand(t){this.componentConfig={...this.componentConfig,expand:t}},changePageTotal(t){this.componentConfig={...this.componentConfig,pageTotal:t},this.componentConfig.current>t&&(this.componentConfig.current=t)},changeCurrent(t){this.componentConfig={...this.componentConfig,current:t}},changeHor(t){this.mode=t?"hor":""},onChange(t){console.log("[onChange]",t),this.componentConfig.current=t}}},[["render",function(t,e,r,l,a,c){const p=m("press-cell"),h=m("demo-block"),u=m("PressPopupCell"),d=m("PressPicker"),g=m("PressPagination");return o(),s("div",{class:"demo-wrap demo-wrap--gray"},[n(h,{title:t.t("basicUsage"),"section-style":a.sectionStyle,"header-style":a.headerStyle},{default:i((()=>[n(p,{title:t.t("custom"),"is-link":"",onClick:c.onShowBasicPopupCell},null,8,["title","onClick"])])),_:1},8,["title","section-style","header-style"]),n(u,{id:a.FUNCTIONAL_ID_MAP.POPUP_CELL,ref:a.FUNCTIONAL_ID_MAP.POPUP_CELL,mode:"functional"},null,8,["id"]),n(d,{id:a.FUNCTIONAL_ID_MAP.PICKER,ref:a.FUNCTIONAL_ID_MAP.PICKER,mode:"functional"},null,8,["id"]),n(g,{total:a.componentConfig.pageTotal,current:a.componentConfig.current,expand:a.componentConfig.expand,mode:a.mode,onChange:c.onChange},null,8,["total","current","expand","mode","onChange"])])}]]);export{k as default};
